# üöÄ –£–¥–∞–ª–µ–Ω–∏–µ —ç–º–æ–¥–∑–∏ –∏–∑ VK –ø–æ—Å—Ç–æ–≤ –∏ OCR –æ—Ç–∑—ã–≤–æ–≤

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ –æ—Ç —ç–º–æ–¥–∑–∏ –∏ —Å–º–∞–π–ª–∏–∫–æ–≤ –≤ –¥–≤—É—Ö –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Å—Ç–∞—Ö:
1. **VK –ø–æ—Å—Ç—ã** - –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –ø–æ—Å—Ç–æ–≤ –∏–∑ –í–ö–æ–Ω—Ç–∞–∫—Ç–µ
2. **OCR –æ—Ç–∑—ã–≤—ã** - –ø—Ä–∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–µ —Ç–µ–∫—Å—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

## ‚ú® –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### 1. –ù–æ–≤–∞—è —É—Ç–∏–ª–∏—Ç–∞ `EmojiRemover.gs`

–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `table/shared/EmojiRemover.gs` —Å 3 —Ñ—É–Ω–∫—Ü–∏—è–º–∏:

- **`removeEmojis(text)`** - —É–¥–∞–ª—è–µ—Ç –≤—Å–µ —ç–º–æ–¥–∑–∏ –∏–∑ —Ç–µ–∫—Å—Ç–∞
- **`containsEmojis(text)`** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —ç–º–æ–¥–∑–∏
- **`countEmojis(text)`** - –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–º–æ–¥–∑–∏

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ VK Import

**–§–∞–π–ª:** `table/server/VkImportService.gs`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
```javascript
// –ë–´–õ–û:
text: String(post.text || '').replace(/\\n/g, ' '),

// –°–¢–ê–õ–û:
var rawText = String(post.text || '').replace(/\\n/g, ' ');
var cleanText = removeEmojis(rawText);  // –£–¥–∞–ª—è–µ–º —ç–º–æ–¥–∑–∏
text: cleanText,
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ VK –ø–æ—Å—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞—é—Ç—Å—è –æ—Ç —ç–º–æ–¥–∑–∏

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ OCR

**–§–∞–π–ª:** `table/client/OcrRunner.gs`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ 2 –º–µ—Å—Ç–∞—Ö:**

#### 3.1 –ü—Ä–∏ batch OCR –∑–∞–ø–∏—Å–∏
```javascript
// –ë–´–õ–û:
var matrix = texts.map(function(x) { return [x]; });

// –°–¢–ê–õ–û:
var matrix = texts.map(function(x) { 
  return [removeEmojis(x)];  // –£–¥–∞–ª—è–µ–º —ç–º–æ–¥–∑–∏
});
```

#### 3.2 –ü—Ä–∏ single-image OCR fallback
```javascript
// –ë–´–õ–û:
return text;

// –°–¢–ê–õ–û:
return removeEmojis(text);  // –£–¥–∞–ª—è–µ–º —ç–º–æ–¥–∑–∏
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–µ –æ—Ç–∑—ã–≤—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞—é—Ç—Å—è –æ—Ç —ç–º–æ–¥–∑–∏

## üéØ Regex Pattern

–£—Ç–∏–ª–∏—Ç–∞ —É–¥–∞–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∏–ø—ã —ç–º–æ–¥–∑–∏:

- **Surrogate pairs** (`\uD800-\uDBFF\uDC00-\uDFFF`) - –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —ç–º–æ–¥–∑–∏
- **Dingbats** (`\u2600-\u27BF`) - —Å–∏–º–≤–æ–ª—ã —Ç–∏–ø–∞ ‚òÄÔ∏è, ‚≠ê, ‚õî
- **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ Unicode –±–ª–æ–∫–∏** (`\uD83C-\uD83E[\uDC00-\uDFFF]`) - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —ç–º–æ–¥–∑–∏
- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã** (`\u2300-\u23FF`)
- **–í–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã** (`\uFE00-\uFE0F`)
- **Zero-width joiners** (`\u200D`) - –æ–±—ä–µ–¥–∏–Ω–∏—Ç–µ–ª–∏ —ç–º–æ–¥–∑–∏
- **Keycap combiners** (`\u20E3`) - —Ü–∏—Ñ—Ä—ã –≤ –∫–≤–∞–¥—Ä–∞—Ç–∞—Ö

## üìä –ü—Ä–∏–º–µ—Ä—ã

### –î–æ:
```
–ü—Ä–∏–≤–µ—Ç! üëã –ö–∞–∫ –¥–µ–ª–∞? üòä
–û—Ç–ª–∏—á–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç! ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
```

### –ü–æ—Å–ª–µ:
```
–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?
–û—Ç–ª–∏—á–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç!
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **VK Import:**
   - –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å—Ç—ã –∏–∑ VK —Å —ç–º–æ–¥–∑–∏
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ç–µ–∫—Å—Ç –æ—á–∏—â–µ–Ω –≤ –ª–∏—Å—Ç–µ "–ø–æ—Å—Ç—ã"

2. **OCR Reviews:**
   - –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å —Ç–µ–∫—Å—Ç–æ–º –∏ —ç–º–æ–¥–∑–∏
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å OCR
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ç–µ–∫—Å—Ç –æ—á–∏—â–µ–Ω –≤ –ª–∏—Å—Ç–µ "–û—Ç–∑—ã–≤—ã"

### Unit —Ç–µ—Å—Ç—ã (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å):
```javascript
function testRemoveEmojis() {
  var input = "–ü—Ä–∏–≤–µ—Ç! üëã –ö–∞–∫ –¥–µ–ª–∞? üòä";
  var expected = "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?";
  var actual = removeEmojis(input);
  
  Logger.log(actual === expected ? "‚úÖ PASS" : "‚ùå FAIL");
}
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

- ‚úÖ –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π —Ñ–∞–π–ª `EmojiRemover.gs`
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ `VkImportService.gs`
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ `OcrRunner.gs` (2 –º–µ—Å—Ç–∞)
- ‚úÖ –ù–µ —Å–ª–æ–º–∞–Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è

## üìù –ö–æ–º–º–∏—Ç

```
feat: –£–¥–∞–ª–µ–Ω–∏–µ —ç–º–æ–¥–∑–∏ –∏–∑ VK –ø–æ—Å—Ç–æ–≤ –∏ OCR –æ—Ç–∑—ã–≤–æ–≤

–†–ï–ê–õ–ò–ó–û–í–ê–ù–û:
‚úÖ –°–æ–∑–¥–∞–Ω–∞ —É—Ç–∏–ª–∏—Ç–∞ EmojiRemover.gs (table/shared/)
‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ VkImportService.gs
‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ OcrRunner.gs (2 –º–µ—Å—Ç–∞)

–†–ï–ó–£–õ–¨–¢–ê–¢:
–í—Å–µ –ø–æ—Å—Ç—ã –∏ –æ—Ç–∑—ã–≤—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞—é—Ç—Å—è –æ—Ç —ç–º–æ–¥–∑–∏
```

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ —ç—Ç–æ–≥–æ PR:
1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–∞—Å—à–∏—Ä–∏—Ç—å regex pattern
3. –î–æ–±–∞–≤–∏—Ç—å unit —Ç–µ—Å—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
4. –î–æ–±–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É –≤–∫–ª—é—á–µ–Ω–∏—è/–≤—ã–∫–ª—é—á–µ–Ω–∏—è –æ—á–∏—Å—Ç–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

**–ê–≤—Ç–æ—Ä:** Droid (Factory AI)  
**–î–∞—Ç–∞:** 2025-01-26  
**–í–µ—Ç–∫–∞:** `feature/remove-emojis-from-posts`  
**–ö–æ–º–º–∏—Ç:** 966a0bf

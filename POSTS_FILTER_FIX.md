# üéØ Posts Filter Fix - –ì–ï–ù–ò–ê–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï!

## üîç **–ü–†–û–ë–õ–ï–ú–ê**

**–ö–æ–≥–¥–∞ –∫–æ–ø–∏—Ä—É–µ–º –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã ‚Üí –∫–æ–ø–∏—Ä—É—é—Ç—Å—è —Ñ–æ—Ä–º—É–ª—ã, –∞ –Ω–µ —Ç–µ–∫—Å—Ç!**

### **–¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–∏—Å—Ç–∞ "–ø–æ—Å—Ç—ã":**
```
A: –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ (VK/Instagram/Telegram)
B: –î–∞—Ç–∞ –ø–æ—Å—Ç–∞
C: –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ—Å—Ç
D: –¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ (–æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç)
E: –°—Ç–æ–ø-—Å–ª–æ–≤–∞ (–≤–≤–æ–¥–∏–º –∑–¥–µ—Å—å)
F: –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ (=IF(SUMPRODUCT(...), "", C...)) ‚Üê –§–û–†–ú–£–õ–ê!
G: –ù–æ–º–µ—Ä –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö
H: –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —Å–ª–æ–≤–∞ (–≤–≤–æ–¥–∏–º –∑–¥–µ—Å—å)
I: –° –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–º–∏ (=IF(SUMPRODUCT(...), C..., "")) ‚Üê –§–û–†–ú–£–õ–ê!
J: –ù–æ–º–µ—Ä –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö
```

### **–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–æ–ª–æ–Ω–∫–∏ F –∏ I —Å–æ–¥–µ—Ä–∂–∞—Ç –§–û–†–ú–£–õ–´ —Å—Å—ã–ª–∞—é—â–∏–µ—Å—è –Ω–∞ C (—Å—Å—ã–ª–∫—É)
- –ü—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ ‚Üí –≤—Å—Ç–∞–≤–ª—è—é—Ç—Å—è —Ñ–æ—Ä–º—É–ª—ã, –∞ –Ω–µ –∑–Ω–∞—á–µ–Ω–∏—è
- –ù—É–∂–µ–Ω —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–æ–≤ (D), –∞ –Ω–µ —Å—Å—ã–ª–∫–∏ (C)!

---

## ‚úÖ **–†–ï–®–ï–ù–ò–ï 1: –ò–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º—É–ª—ã –Ω–∞ –∫–æ–ª–æ–Ω–∫—É D**

**–°–∞–º–æ–µ –ø—Ä–æ—Å—Ç–æ–µ - —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ D (—Ç–µ–∫—Å—Ç), –∞ –Ω–µ C (—Å—Å—ã–ª–∫–∞):**

```javascript
// –ë—ã–ª–æ:
var formulaF = '=IF(SUMPRODUCT(...), "", C' + row + ')';
var formulaI = '=IF(SUMPRODUCT(...), C' + row + ', "")';

// –°—Ç–∞–Ω–µ—Ç:
var formulaF = '=IF(SUMPRODUCT(...), "", D' + row + ')';
var formulaI = '=IF(SUMPRODUCT(...), D' + row + ', "")';
```

**–¢–µ–ø–µ—Ä—å —Ñ–æ—Ä–º—É–ª—ã –≤–µ—Ä–Ω—É—Ç –¢–ï–ö–°–¢ –ø–æ—Å—Ç–∞ (D), –Ω–µ —Å—Å—ã–ª–∫—É (C)!**

---

## ‚úÖ **–†–ï–®–ï–ù–ò–ï 2: –î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è"**

**–ï—â—ë –ª—É—á—à–µ - –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É/—Ñ—É–Ω–∫—Ü–∏—é –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è VALUES:**

```javascript
/**
 * –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã (—Ç–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏—è)
 */
function copyFilteredPostsAsValues() {
  var ss = SpreadsheetApp.getActive();
  var sheet = ss.getSheetByName('–ø–æ—Å—Ç—ã');
  
  if (!sheet) {
    SpreadsheetApp.getUi().alert('–õ–∏—Å—Ç "–ø–æ—Å—Ç—ã" –Ω–µ –Ω–∞–π–¥–µ–Ω!');
    return;
  }
  
  // –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã (F –∫–æ–ª–æ–Ω–∫–∞)
  var lastRow = sheet.getLastRow();
  var filteredData = sheet.getRange(2, 6, lastRow - 1, 1).getValues(); // F2:F
  
  // –°–æ–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–µ–ø—É—Å—Ç—ã–µ
  var postsToCopy = [];
  for (var i = 0; i < filteredData.length; i++) {
    if (filteredData[i][0] && filteredData[i][0] !== '') {
      postsToCopy.push([filteredData[i][0]]);
    }
  }
  
  if (postsToCopy.length === 0) {
    SpreadsheetApp.getUi().alert('–ù–µ—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤!');
    return;
  }
  
  // –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π –ª–∏—Å—Ç —Å VALUES
  var copySheet = ss.getSheetByName('–ö–æ–ø–∏—è –ø–æ—Å—Ç–æ–≤');
  if (copySheet) {
    ss.deleteSheet(copySheet);
  }
  copySheet = ss.insertSheet('–ö–æ–ø–∏—è –ø–æ—Å—Ç–æ–≤');
  
  // –í—Å—Ç–∞–≤–ª—è–µ–º –ó–ù–ê–ß–ï–ù–ò–Ø (–Ω–µ —Ñ–æ—Ä–º—É–ª—ã)
  copySheet.getRange(1, 1, postsToCopy.length, 1).setValues(postsToCopy);
  
  SpreadsheetApp.getUi().alert('‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ ' + postsToCopy.length + ' –ø–æ—Å—Ç–æ–≤ –≤ –ª–∏—Å—Ç "–ö–æ–ø–∏—è –ø–æ—Å—Ç–æ–≤"!');
  
  // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –Ω–æ–≤—ã–π –ª–∏—Å—Ç
  ss.setActiveSheet(copySheet);
}
```

---

## ‚úÖ **–†–ï–®–ï–ù–ò–ï 3: –î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É K "–¢–µ–∫—Å—Ç –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è"**

**Hybrid –ø–æ–¥—Ö–æ–¥ - –æ—Å—Ç–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É–ª—ã, –Ω–æ –¥–æ–±–∞–≤–∏—Ç—å VALUES –∫–æ–ª–æ–Ω–∫—É:**

```javascript
// –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è F –∏ I, –¥–æ–±–∞–≤–ª—è–µ–º K:
for (var row = 2; row <= totalRows; row++) {
  // K - –ó–ù–ê–ß–ï–ù–ò–Ø –∏–∑ F –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
  sheet.getRange(row, 11).setValue(
    sheet.getRange(row, 6).getValue() // –ë–µ—Ä—ë–º –ó–ù–ê–ß–ï–ù–ò–ï –∏–∑ F
  );
}

// –ó–∞–≥–æ–ª–æ–≤–æ–∫
sheet.getRange(1, 11).setValue('üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—Å—é–¥–∞').setFontWeight('bold').setBackground('#E8F5E9');
```

**–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ K - —Ç–∞–º —á–∏—Å—Ç—ã–µ VALUES!**

---

## üéØ **–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø**

**–õ–£–ß–®–ò–ô –≤–∞—Ä–∏–∞–Ω—Ç = –†–ï–®–ï–ù–ò–ï 1 + –∫–Ω–æ–ø–∫–∞ –≤ –º–µ–Ω—é:**

1. –ò–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º—É–ª—ã F –∏ I –Ω–∞ —Å—Å—ã–ª–∫—É –Ω–∞ D (—Ç–µ–∫—Å—Ç)
2. –î–æ–±–∞–≤–∏—Ç—å –≤ –º–µ–Ω—é —Ñ—É–Ω–∫—Ü–∏—é "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã"
3. –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞—ë—Ç –ª–∏—Å—Ç "–ö–æ–ø–∏—è –ø–æ—Å—Ç–æ–≤" —Å —á–∏—Å—Ç—ã–º–∏ VALUES

**–ü–æ—á–µ–º—É —ç—Ç–æ –ª—É—á—à–µ:**
- ‚úÖ –§–æ—Ä–º—É–ª—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ç–µ–∫—Å—Ç (D)
- ‚úÖ –ö–Ω–æ–ø–∫–∞ –∫–æ–ø–∏—Ä—É–µ—Ç VALUES –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –¥—É–º–∞–µ—Ç - –ø—Ä–æ—Å—Ç–æ –Ω–∞–∂–∏–º–∞–µ—Ç
- ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ª–∏—Å—Ç–µ - —É–¥–æ–±–Ω–æ

---

## üöÄ **IMPLEMENTATION**

### **1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É–ª—ã (VkImportService.gs):**

```javascript
// –°—Ç—Ä–æ–∫–∞ 168: –ë—ã–ª–æ C, —Å—Ç–∞–Ω–µ—Ç D
var formulaF = '=IF(SUMPRODUCT(--(ISNUMBER(SEARCH(' + stopWordsRange + ', D' + row + ')))*(' + stopWordsRange + '<>\"\")) > 0, \"\", D' + row + ')';

// –°—Ç—Ä–æ–∫–∞ 182: –ë—ã–ª–æ C, —Å—Ç–∞–Ω–µ—Ç D  
var formulaI = '=IF(SUMPRODUCT(--(ISNUMBER(SEARCH(' + positiveWordsRange + ', D' + row + ')))*(' + positiveWordsRange + '<>\"\")) > 0, D' + row + ', \"\")';
```

### **2. –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è (Menu.gs):**

```javascript
.addItem('üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã', 'copyFilteredPostsAsValuesWithHelp')
```

### **3. –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é (ClientUtilities.gs):**

```javascript
function copyFilteredPostsAsValuesWithHelp() {
  var ui = SpreadsheetApp.getUi();
  var instruction = `üìã –ö–û–ü–ò–†–û–í–ê–¢–¨ –û–¢–§–ò–õ–¨–¢–†–û–í–ê–ù–ù–´–ï –ü–û–°–¢–´
  
–ö–æ–ø–∏—Ä—É–µ—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã –∫–∞–∫ —á–∏—Å—Ç—ã–π —Ç–µ–∫—Å—Ç (–±–µ–∑ —Ñ–æ—Ä–º—É–ª).

üìã –ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
‚Ä¢ –ù–∞—Ö–æ–¥–∏—Ç –≤—Å–µ –ø–æ—Å—Ç—ã –≤ –∫–æ–ª–æ–Ω–∫–µ F (–ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞ —Å—Ç–æ–ø-—Å–ª–æ–≤)
‚Ä¢ –ö–æ–ø–∏—Ä—É–µ—Ç –∏—Ö –∫–∞–∫ –ó–ù–ê–ß–ï–ù–ò–Ø (–Ω–µ —Ñ–æ—Ä–º—É–ª—ã)
‚Ä¢ –°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π –ª–∏—Å—Ç "–ö–æ–ø–∏—è –ø–æ—Å—Ç–æ–≤"
‚Ä¢ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —ç—Ç–æ—Ç –ª–∏—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

üí° –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫—É–¥–∞ —É–≥–æ–¥–Ω–æ –±–µ–∑ —Ñ–æ—Ä–º—É–ª!`;

  var result = ui.alert('–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è', instruction, ui.ButtonSet.OK_CANCEL);
  if (result === ui.Button.OK) {
    copyFilteredPostsAsValues();
  }
}
```

---

## ‚úÖ **–†–ï–ó–£–õ–¨–¢–ê–¢**

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
1. –§–∏–ª—å—Ç—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¢–ï–ö–°–¢ –ø–æ—Å—Ç–æ–≤ (D), –Ω–µ —Å—Å—ã–ª–∫–∏ (C)
2. –ö–Ω–æ–ø–∫–∞ "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ" ‚Üí –ª–∏—Å—Ç —Å VALUES
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–æ–ø–∏—Ä—É–µ—Ç –æ—Ç–∫—É–¥–∞ —Ö–æ—á–µ—Ç ‚Üí –ø–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—Å—Ç!

**–≠–¢–û –ì–ï–ù–ò–ê–õ–¨–ù–û! üéØ‚ú®**

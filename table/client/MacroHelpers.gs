/**
 * Macro Helpers
 * –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–∞–∫—Ä–æ—Å–æ–≤ —Å –≥–æ—Ä—è—á–∏–º–∏ –∫–ª–∞–≤–∏—à–∞–º–∏
 * 
 * –í–ê–ñ–ù–û: –≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –¢–ï–ö–£–©–ï–ô –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π —è—á–µ–π–∫–æ–π,
 * –∞ –Ω–µ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω–æ–π!
 */

/**
 * üîÑ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤—ã–¥–µ–ª–µ–Ω–Ω—É—é —è—á–µ–π–∫—É –≤ GM()
 * –ù–∞–∑–Ω–∞—á—å—Ç–µ –Ω–∞ –≥–æ—Ä—è—á—É—é –∫–ª–∞–≤–∏—à—É —á–µ—Ä–µ–∑ –º–∞–∫—Ä–æ—Å!
 * –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∫–ª–∞–≤–∏—à–∞: Ctrl+Alt+Shift+1
 */
function macroConvertToGM() {
  // –ü—Ä–æ—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é
  // –û–Ω–∞ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å sheet.getActiveRange()
  convertTextToGMFormula();
}

/**
 * üîí –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤—ã–¥–µ–ª–µ–Ω–Ω—É—é —è—á–µ–π–∫—É –≤ GM_STATIC()
 * –ù–∞–∑–Ω–∞—á—å—Ç–µ –Ω–∞ –≥–æ—Ä—è—á—É—é –∫–ª–∞–≤–∏—à—É —á–µ—Ä–µ–∑ –º–∞–∫—Ä–æ—Å!
 * –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∫–ª–∞–≤–∏—à–∞: Ctrl+Alt+Shift+2
 */
function macroConvertToGMStatic() {
  // –ü—Ä–æ—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é
  // –û–Ω–∞ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å sheet.getActiveRange()
  convertTextToGMStaticFormula();
}

/**
 * üß† –ü—Ä–∏–º–µ–Ω–∏—Ç—å —É–º–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∫ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π —è—á–µ–π–∫–µ
 * –ù–∞–∑–Ω–∞—á—å—Ç–µ –Ω–∞ –≥–æ—Ä—è—á—É—é –∫–ª–∞–≤–∏—à—É —á–µ—Ä–µ–∑ –º–∞–∫—Ä–æ—Å!
 * –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∫–ª–∞–≤–∏—à–∞: Ctrl+Alt+Shift+3
 */
function macroApplySmartRules() {
  // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é —É–º–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª
  applySmartRulesToSelection();
}

/**
 * ‚ö° –ë–´–°–¢–†–û–ï –ü–†–ï–û–ë–†–ê–ó–û–í–ê–ù–ò–ï - –ø—Ä–æ—Å—Ç–æ –≤—ã–∑–æ–≤–∏—Ç–µ —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é
 * –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±–æ–π –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π —è—á–µ–π–∫–æ–π!
 * 
 * –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
 * 1. –í—ã–¥–µ–ª–∏—Ç–µ —è—á–µ–π–∫—É —Å —Ç–µ–∫—Å—Ç–æ–º
 * 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é (–∏–ª–∏ –Ω–∞–∑–Ω–∞—á—å—Ç–µ –Ω–∞ –≥–æ—Ä—è—á—É—é –∫–ª–∞–≤–∏—à—É)
 * 3. –¢–µ–∫—Å—Ç —Å—Ç–∞–Ω–µ—Ç —Ñ–æ—Ä–º—É–ª–æ–π =GM("—Ç–µ–∫—Å—Ç")
 */
function quickConvertGM() {
  try {
    var sheet = SpreadsheetApp.getActiveSheet();
    var range = sheet.getActiveRange();
    
    if (!range) {
      SpreadsheetApp.getUi().alert('–í—ã–¥–µ–ª–∏—Ç–µ —è—á–µ–π–∫—É!');
      return;
    }
    
    // –í—ã–∑—ã–≤–∞–µ–º –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä
    convertTextToGMFormula();
    
  } catch (error) {
    SpreadsheetApp.getUi().alert('–û—à–∏–±–∫–∞: ' + error.message);
  }
}

/**
 * ‚ö° –ë–´–°–¢–†–û–ï –ü–†–ï–û–ë–†–ê–ó–û–í–ê–ù–ò–ï –í STATIC
 */
function quickConvertGMStatic() {
  try {
    var sheet = SpreadsheetApp.getActiveSheet();
    var range = sheet.getActiveRange();
    
    if (!range) {
      SpreadsheetApp.getUi().alert('–í—ã–¥–µ–ª–∏—Ç–µ —è—á–µ–π–∫—É!');
      return;
    }
    
    convertTextToGMStaticFormula();
    
  } catch (error) {
    SpreadsheetApp.getUi().alert('–û—à–∏–±–∫–∞: ' + error.message);
  }
}

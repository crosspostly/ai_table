# üìö –ü–æ–ª–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ñ—É–Ω–∫—Ü–∏–π Table AI Bot v2.0

## üìñ –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [üéØ –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ (Client)](#-–∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ-—Ñ—É–Ω–∫—Ü–∏–∏-client)
  - [Gemini AI Functions](#gemini-ai-functions)
  - [Social Import Functions](#social-import-functions)
  - [Utility Functions](#utility-functions)
  - [UI Functions](#ui-functions)
- [üñ•Ô∏è –°–µ—Ä–≤–µ—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (Server)](#Ô∏è-—Å–µ—Ä–≤–µ—Ä–Ω—ã–µ-—Ñ—É–Ω–∫—Ü–∏–∏-server)
  - [API Endpoints](#api-endpoints)
  - [Social Import Services](#social-import-services)
  - [OCR Services](#ocr-services)
  - [License Services](#license-services)
- [üîó –û–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ (Shared)](#-–æ–±—â–∏–µ-—Ñ—É–Ω–∫—Ü–∏–∏-shared)
  - [Logging](#logging)
  - [Markdown Processing](#markdown-processing)
  - [A1 Notation Helpers](#a1-notation-helpers)

---

## üéØ –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ (Client)

### Gemini AI Functions

#### `GM(prompt, maxTokens, temperature)`
**–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–∑–æ–≤–∞ Gemini API**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `prompt` (string, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - —Ç–µ–∫—Å—Ç –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è AI
- `maxTokens` (number, optional) - –º–∞–∫—Å–∏–º—É–º —Ç–æ–∫–µ–Ω–æ–≤ –æ—Ç–≤–µ—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 250000)
- `temperature` (number, optional) - —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.7)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** string - –æ—Ç–≤–µ—Ç –æ—Ç Gemini AI

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –ø—Ä–æ–º–ø—Ç (–Ω–µ –ø—É—Å—Ç–æ–π, —Å—Ç—Ä–æ–∫–∞, –¥–æ 500–∫ —Å–∏–º–≤–æ–ª–æ–≤)
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—ç—à (–∫–ª—é—á = SHA256(prompt+maxTokens+temp))
3. –ï—Å–ª–∏ –≤ –∫—ç—à–µ - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
4. –ò–Ω–∞—á–µ - –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ Gemini API —Å retry –ª–æ–≥–∏–∫–æ–π
5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç Markdown –≤ —É–¥–æ–±–æ—á–∏—Ç–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç
6. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –∫—ç—à (TTL 5 –º–∏–Ω—É—Ç)
7. –õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```javascript
=GM("–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ç–µ–∫—Å—Ç: " & A2, 2000, 0.7)
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (ScriptCache + Properties)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ Markdown
- ‚úÖ Retry –ª–æ–≥–∏–∫–∞ –ø—Ä–∏ —Å–±–æ—è—Ö
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

#### `GM_STATIC(prompt, maxTokens, temperature)`
**–°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–µ—Ä—Å–∏—è GM - –∞–≤—Ç–æ–∑–∞–º–µ–Ω–∞ —Ñ–æ—Ä–º—É–ª—ã –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ò–¥–µ–Ω—Ç–∏—á–Ω—ã `GM()`

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** string - –æ—Ç–≤–µ—Ç –æ—Ç Gemini AI

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –í—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å–µ —à–∞–≥–∏ —Ñ—É–Ω–∫—Ü–∏–∏ `GM()`
2. **–ö–†–ò–¢–ò–ß–ù–û:** –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –∑–∞–º–µ–Ω—è–µ—Ç —Ñ–æ—Ä–º—É–ª—É –Ω–∞ —Å—Ç–∞—Ç–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
3. –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ API –≤—ã–∑–æ–≤—ã –ø—Ä–∏ –ø–µ—Ä–µ—Å—á–µ—Ç–µ —Ç–∞–±–ª–∏—Ü—ã

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```javascript
=GM_STATIC("–°–æ–∑–¥–∞–π –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ: " & A2)
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –î–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å
- ‚úÖ –î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ API –∫–≤–æ—Ç
- ‚úÖ –î–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Ç–∞–±–ª–∏—Ü—ã
- ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

---

#### `GM_IF(condition, prompt, maxTokens, temperature)`
**–£—Å–ª–æ–≤–Ω—ã–π –≤—ã–∑–æ–≤ Gemini - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —É—Å–ª–æ–≤–∏—è**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `condition` (any) - —É—Å–ª–æ–≤–∏–µ –∑–∞–ø—É—Å–∫–∞ (boolean, number, string)
- `prompt` (string) - –ø—Ä–æ–º–ø—Ç –¥–ª—è AI
- `maxTokens` (number, optional) - –º–∞–∫—Å–∏–º—É–º —Ç–æ–∫–µ–Ω–æ–≤
- `temperature` (number, optional) - —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** string - –æ—Ç–≤–µ—Ç –æ—Ç Gemini –∏–ª–∏ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç —É—Å–ª–æ–≤–∏–µ –≤ boolean:
   - `true` / –Ω–µ-0 —á–∏—Å–ª–æ / –Ω–µ–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Üí true
   - `false` / 0 / "false" / "0" / "no" / "–Ω–µ—Ç" ‚Üí false
2. –ï—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ –∏—Å—Ç–∏–Ω–Ω–æ - –≤—ã–∑—ã–≤–∞–µ—Ç `GM()`
3. –ò–Ω–∞—á–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```javascript
=GM_IF($A3<>"", "–û–±—Ä–∞–±–æ—Ç–∞–π –¥–∞–Ω–Ω—ã–µ –∏–∑ A3: " & A3, 5000, 0.8)
=GM_IF(LEN(B3)>100, "–°–æ–∫—Ä–∞—Ç–∏ —Ç–µ–∫—Å—Ç: " & B3, 1000, 0.5)
```

**–£–º–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏:**
```javascript
// B3 –∑–∞–≤–∏—Å–∏—Ç –æ—Ç A3
=GM_IF($A3<>"", Prompt_box!$F$2)

// C3 –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ B3
=GM_IF(LEFT(B3, LEN("–û—Ç—á—ë—Ç –≥–æ—Ç–æ–≤"))="–û—Ç—á—ë—Ç –≥–æ—Ç–æ–≤", Prompt_box!$F$3)
```

---

#### `GM_IF_STATIC(condition, prompt, maxTokens, temperature)`
**–£—Å–ª–æ–≤–Ω—ã–π —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤ - –∫–æ–º–±–∏–Ω–∞—Ü–∏—è GM_IF + GM_STATIC**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ò–¥–µ–Ω—Ç–∏—á–Ω—ã `GM_IF()`

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏–µ
2. –ï—Å–ª–∏ true - –≤—ã–∑—ã–≤–∞–µ—Ç `GM_STATIC()` (—Å –∞–≤—Ç–æ–∑–∞–º–µ–Ω–æ–π –Ω–∞ —Å—Ç–∞—Ç–∏–∫—É)
3. –ò–Ω–∞—á–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```javascript
=GM_IF_STATIC(COUNTIF($A$2:$A$100, ">0")>10, "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ç—Ä–µ–Ω–¥—ã", 3000, 0.7)
```

---

### Social Import Functions

#### `importSocialPosts()`
**–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç –ø–æ—Å—Ç–æ–≤ –∏–∑ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç (—á–∏—Ç–∞–µ—Ç –∏–∑ –ª–∏—Å—Ç–∞ "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã")

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –ª–∏—Å—Ç–∞ "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã"
2. –ß–∏—Ç–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
   - `B1` - –∏—Å—Ç–æ—á–Ω–∏–∫ (URL –∏–ª–∏ username)
   - `B2` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤ (1-100)
   - `B3` - VK Access Token (–¥–ª—è VK)
   - `C1` - –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
3. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–ª–∏ –ø–æ C1
4. –í—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø–∞—Ä—Å–µ—Ä:
   - Instagram: –ø—Ä—è–º–æ–π API –∑–∞–ø—Ä–æ—Å
   - VK: —á–µ—Ä–µ–∑ VK API —Å access token
   - Telegram: RSS ‚Üí Web preview ‚Üí Embed (fallback)
5. –°–æ–∑–¥–∞–µ—Ç/–æ—á–∏—â–∞–µ—Ç –ª–∏—Å—Ç "–ø–æ—Å—Ç—ã"
6. –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
   - A: –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞
   - B: –î–∞—Ç–∞
   - C: –°—Å—ã–ª–∫–∞
   - D: –¢–µ–∫—Å—Ç
   - E-J: –°—Ç–æ–ª–±—Ü—ã –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞
7. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç —Ñ–æ—Ä–º—É–ª—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Å—Ç–æ–ø-—Å–ª–æ–≤–∞–º –∏ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–º —Å–ª–æ–≤–∞–º

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:**

**Instagram:**
```
https://instagram.com/username
https://www.instagram.com/username  
instagram.com/username
username (+ C1="–∏–Ω—Å—Ç–∞")
```

**VK:**
```
https://vk.com/username
-12345678 (ID –≥—Ä—É–ø–ø—ã - –û–¢–†–ò–¶–ê–¢–ï–õ–¨–ù–´–ô)
12345678 (ID —Å—Ç—Ä–∞–Ω–∏—Ü—ã)
@username
username (+ C1="–≤–∫")
```

**Telegram:**
```
https://t.me/channel
t.me/channel
@channel
channel (+ C1="—Ç–≥")
```

**–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤:**

–ü–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è:

1. **–°—Ç–æ–ª–±—Ü—ã E-G (–°—Ç–æ–ø-—Å–ª–æ–≤–∞):**
   - E: –°–ø–∏—Å–æ–∫ —Å—Ç–æ–ø-—Å–ª–æ–≤ (–∫–∞–∂–¥–æ–µ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —è—á–µ–π–∫–µ)
   - F: –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã (—Ñ–æ—Ä–º—É–ª–∞ —Å–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Å—Ç—ã —Å–æ —Å—Ç–æ–ø-—Å–ª–æ–≤–∞–º–∏)
   - G: –ù–æ–≤–∞—è –Ω—É–º–µ—Ä–∞—Ü–∏—è (—Ç–æ–ª—å–∫–æ –Ω–µ–ø—É—Å—Ç—ã—Ö –ø–æ—Å—Ç–æ–≤ –∏–∑ F)

2. **–°—Ç–æ–ª–±—Ü—ã H-J (–ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —Å–ª–æ–≤–∞):**
   - H: –°–ø–∏—Å–æ–∫ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö —Å–ª–æ–≤
   - I: –ü–æ—Å—Ç—ã —Å –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏ (—Ñ–æ—Ä–º—É–ª–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∏—Ö)
   - J: –ù—É–º–µ—Ä–∞—Ü–∏—è –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤

**–§–æ—Ä–º—É–ª—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:**

```javascript
// F2 - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ—Å—Ç D2 –ø—Ä–æ—Ç–∏–≤ –í–°–ï–• —Å—Ç–æ–ø-—Å–ª–æ–≤ –≤ E2:E100
=IF(SUMPRODUCT(--(ISNUMBER(SEARCH($E$2:$E$100, D2)))*($E$2:$E$100<>"")) > 0, "", D2)

// G2 - –Ω—É–º–µ—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–µ–ø—É—Å—Ç—ã–µ F
=IF(F2<>"", COUNTA(F$2:F2), "")

// I2 - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—Å—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –ø–æ–∑–∏—Ç–∏–≤–Ω–æ–µ —Å–ª–æ–≤–æ
=IF(SUMPRODUCT(--(ISNUMBER(SEARCH($H$2:$H$100, D2)))*($H$2:$H$100<>"")) > 0, D2, "")

// J2 - –Ω—É–º–µ—Ä—É–µ—Ç –ø–æ—Å—Ç—ã —Å –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏
=IF(I2<>"", COUNTA(I$2:I2), "")
```

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

1. –°–æ–∑–¥–∞–π—Ç–µ –ª–∏—Å—Ç "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã":
```
| A             | B                           | C        |
|---------------|-----------------------------|----------|
| –ò—Å—Ç–æ—á–Ω–∏–∫:     | https://instagram.com/nasa  |          |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:   | 20                          |          |
| VK Token:     | (–¥–ª—è VK –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)        |          |
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ –º–µ–Ω—é: ü§ñ Table AI ‚Üí üì± –ü–æ–ª—É—á–∏—Ç—å VK –ø–æ—Å—Ç—ã

3. –î–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:
   - –í —Å—Ç–æ–ª–±—Ü–µ E —É–∫–∞–∂–∏—Ç–µ —Å—Ç–æ–ø-—Å–ª–æ–≤–∞ (–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è, –ø—Å–∏—Ö–æ–ª–æ–≥, –∏ —Ç.–¥.)
   - –í —Å—Ç–æ–ª–±—Ü–µ H —É–∫–∞–∂–∏—Ç–µ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —Å–ª–æ–≤–∞ (—É—Å–ø–µ—Ö, —Ä–æ—Å—Ç, –∏ —Ç.–¥.)
   - –§–æ—Ä–º—É–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä—É—é—Ç –ø–æ—Å—Ç—ã

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- ‚ùå "–õ–∏—Å—Ç –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω" ‚Üí —Å–æ–∑–¥–∞–π—Ç–µ –ª–∏—Å—Ç
- ‚ùå "–ò—Å—Ç–æ—á–Ω–∏–∫ –Ω–µ —É–∫–∞–∑–∞–Ω" ‚Üí –∑–∞–ø–æ–ª–Ω–∏—Ç–µ B1
- ‚ùå "–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞" ‚Üí —É–∫–∞–∂–∏—Ç–µ C1 –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª–Ω—É—é —Å—Å—ã–ª–∫—É https://
- ‚ùå "VK_TOKEN –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω" ‚Üí —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º (—Ç–æ–∫–µ–Ω –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
- ‚ùå "Instagram API unavailable" ‚Üí –ø–æ–¥–æ–∂–¥–∏—Ç–µ 1-2 —á–∞—Å–∞

---

#### `importVkPosts()` 
**–ê–ª–∏–∞—Å –¥–ª—è `importSocialPosts()` - –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**

–í—ã–∑—ã–≤–∞–µ—Ç `importSocialPosts()` –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –∏–∑ –ª—é–±–æ–π —Å–æ—Ü—Å–µ—Ç–∏.

---

### Utility Functions

#### `checkLicenseStatusUI()`
**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ª–∏—Ü–µ–Ω–∑–∏–∏ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –≤ UI**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü–æ–ª—É—á–∞–µ—Ç credentials –∏–∑ Script Properties
2. –î–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É: `{action: 'check_license', email, token}`
3. –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ª–∏—Ü–µ–Ω–∑–∏–∏:
   - valid: –∞–∫—Ç–∏–≤–Ω–∞ –ª–∏
   - expiresAt: –¥–∞—Ç–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è
   - requestsThisHour: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –∑–∞–ø—Ä–æ—Å–æ–≤
   - hourlyLimit: –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤
   - totalRequests: –≤—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤
4. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫—Ä–∞—Å–∏–≤—ã–π –¥–∏–∞–ª–æ–≥ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
–ú–µ–Ω—é ‚Üí ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí üìä –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ª–∏—Ü–µ–Ω–∑–∏–∏

---

#### `setLicenseCredentialsUI()`
**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ email –∏ —Ç–æ–∫–µ–Ω–∞ –ª–∏—Ü–µ–Ω–∑–∏–∏ —á–µ—Ä–µ–∑ UI**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç prompt –¥–ª—è –≤–≤–æ–¥–∞ email
2. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç prompt –¥–ª—è –≤–≤–æ–¥–∞ —Ç–æ–∫–µ–Ω–∞
3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ Script Properties:
   - `LICENSE_EMAIL`
   - `LICENSE_TOKEN`
4. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
–ú–µ–Ω—é ‚Üí ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí üîê –õ–∏—Ü–µ–Ω–∑–∏—è: Email + –¢–æ–∫–µ–Ω

---

#### `initGeminiKey()`
**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Gemini API –∫–ª—é—á–∞**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç prompt —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –ø–æ–ª—É—á–µ–Ω–∏—è –∫–ª—é—á–∞
2. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ Script Properties: `GEMINI_API_KEY`
3. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

**–ì–¥–µ –ø–æ–ª—É—á–∏—Ç—å –∫–ª—é—á:**
https://aistudio.google.com/app/apikey

---

#### `setCompletionPhraseUI()`
**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ—Ä–∞–∑—ã –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –¥–ª—è –∞–≤—Ç–æ—Ü–µ–ø–æ—á–µ–∫**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç prompt –¥–ª—è –≤–≤–æ–¥–∞ —Ñ—Ä–∞–∑—ã
2. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ Script Properties: `COMPLETION_PHRASE`
3. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: "–û—Ç—á—ë—Ç –≥–æ—Ç–æ–≤"

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
–ê–≤—Ç–æ—Ü–µ–ø–æ—á–∫–∏ –∂–¥—É—Ç —ç—Ç—É —Ñ—Ä–∞–∑—É –≤ –Ω–∞—á–∞–ª–µ –æ—Ç–≤–µ—Ç–∞ —á—Ç–æ–±—ã –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É:
```
B3: "–û—Ç—á—ë—Ç –≥–æ—Ç–æ–≤: –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã..." ‚Üí C3 –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
C3: "–ï—â–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é..." ‚Üí D3 –ù–ï –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```

---

#### `clearChainForA3()`
**–û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—É–ª –∞–≤—Ç–æ—Ü–µ–ø–æ—á–∫–∏ B3:G3**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ù–∞—Ö–æ–¥–∏—Ç –ª–∏—Å—Ç "–†–∞—Å–ø–∞–∫–æ–≤–∫–∞"
2. –û—á–∏—â–∞–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω B3:G3
3. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –¶–µ–ø–æ—á–∫–∞ "–∑–∞–≤–∏—Å–ª–∞"
- –ù—É–∂–Ω–æ –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ
- –û—à–∏–±–∫–∞ –≤ —Ñ–æ—Ä–º—É–ª–∞—Ö

---

#### `cleanupOldTriggers()`
**–£–¥–∞–ª–µ–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞: `ScriptApp.getProjectTriggers()`
2. –£–¥–∞–ª—è–µ—Ç —Ç—Ä–∏–≥–≥–µ—Ä—ã:
   - `checkStepCompletion`
   - `continueAutoProcessingChain`
3. –û—Å—Ç–∞–≤–ª—è–µ—Ç –±–∞–∑–æ–≤—ã–µ:
   - `onEdit`
   - `onOpen`
4. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É: "–£–¥–∞–ª–µ–Ω–æ X —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤"

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –¢—Ä–∏–≥–≥–µ—Ä—ã –Ω–∞–∫–æ–ø–∏–ª–∏—Å—å –∏ –∑–∞–º–µ–¥–ª—è—é—Ç —Ä–∞–±–æ—Ç—É
- –¶–µ–ø–æ—á–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ü–æ—Å–ª–µ –æ—Ç–ª–∞–¥–∫–∏

---

#### `showActiveTriggersDialog()`
**–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü–æ–ª—É—á–∞–µ—Ç —Ç—Ä–∏–≥–≥–µ—Ä—ã: `ScriptApp.getProjectTriggers()`
2. –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫:
   ```
   1. onEdit (ON_EDIT)
   2. checkStepCompletion (CLOCK)
   3. onOpen (ON_OPEN)
   ```
3. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤ –¥–∏–∞–ª–æ–≥–µ

**–î–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º —Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π**

---

#### `refreshCurrentGMCell()`
**–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–µ—Å—á–µ—Ç GM —Ñ–æ—Ä–º—É–ª—ã –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–π —è—á–µ–π–∫–µ**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∞–∫—Ç–∏–≤–Ω–æ–π —è—á–µ–π–∫–æ–π)

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü–æ–ª—É—á–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω—É—é —è—á–µ–π–∫—É: `SpreadsheetApp.getActiveRange()`
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —ç—Ç–æ —Ñ–æ—Ä–º—É–ª–∞ `=GM(` –∏–ª–∏ `=GM_STATIC(` –∏–ª–∏ `=GM_IF(`
3. –û—á–∏—â–∞–µ—Ç —è—á–µ–π–∫—É
4. –ñ–¥–µ—Ç flush: `SpreadsheetApp.flush()`
5. –ó–∞–Ω–æ–≤–æ –≤—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ–æ—Ä–º—É–ª—É ‚Üí —Ñ–æ—Ä—Å–∏—Ä—É–µ—Ç –ø–µ—Ä–µ—Å—á–µ—Ç

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –û—Ç–≤–µ—Ç "–∑–∞–≤–∏—Å"
- –ù—É–∂–µ–Ω —Å–≤–µ–∂–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –ö—ç—à —É—Å—Ç–∞—Ä–µ–ª

---

### UI Functions

#### `initializeChatMode()`
**–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —á–∞—Ç-—Ä–µ–∂–∏–º–∞ —Å AI**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞ "–ß–∞—Ç" / "Chat"
2. –ï—Å–ª–∏ –µ—Å—Ç—å - —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –ª–∏
3. –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –ª–∏—Å—Ç "–ß–∞—Ç":
   ```
   | A: –í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ      | B: –û—Ç–≤–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞    |
   |------------------------|------------------------|
   | –ù–∞–ø–∏—à–∏—Ç–µ –≤–æ–ø—Ä–æ—Å –∑–¥–µ—Å—å  |                        |
   ```
4. –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏ (—Å–∏–Ω–∏–π —Ñ–æ–Ω, –±–µ–ª—ã–π —Ç–µ–∫—Å—Ç)
5. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —à–∏—Ä–∏–Ω—É –∫–æ–ª–æ–Ω–æ–∫: A=400px, B=600px

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
1. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ —á–µ—Ä–µ–∑ –º–µ–Ω—é: ü§ñ Table AI ‚Üí üß† –†–µ–∂–∏–º —á–∞—Ç–∞
2. –ù–∞–ø–∏—à–∏—Ç–µ –≤–æ–ø—Ä–æ—Å –≤ A2
3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–æ—Ä–º—É–ª—É –≤ B2: `=GM(A2)`
4. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ A2 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç—Å—è B2

**–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ö–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä–∞: –≤–∫–ª—é—á–∏—Ç–µ —á–µ–∫–±–æ–∫—Å –≤ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã!D1
- –£–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã: "–ü—Ä–æ–º–ø—Ç: –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –Ω–∞—à–∞ –Ω–∏—à–∞"
- –ò—Å—Ç–æ—Ä–∏—è –æ–±—â–µ–Ω–∏—è: —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ PDF/CSV

---

#### `setupSmartPromptTrigger()`
**–ê–∫—Ç–∏–≤–∞—Ü–∏—è —É–º–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤ - –∞–≤—Ç–æ–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ —Ñ–æ—Ä–º—É–ª—ã**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ç—Ä–∏–≥–≥–µ—Ä `onSmartPromptEdit`
2. –ï—Å–ª–∏ –Ω–µ—Ç - —Å–æ–∑–¥–∞–µ—Ç:
   ```javascript
   ScriptApp.newTrigger('onSmartPromptEdit')
     .forSpreadsheet(SpreadsheetApp.getActive())
     .onEdit()
     .create();
   ```
3. –°–æ–∑–¥–∞–µ—Ç –ª–∏—Å—Ç "–ü—Ä–∞–≤–∏–ª–∞" —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –ø—Ä–∞–≤–∏–ª –∑–∞–º–µ–Ω—ã:
   ```
   | –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ   | –°—Å—ã–ª–∫–∞ –Ω–∞ —è—á–µ–π–∫—É |
   |------------------|------------------|
   | –Ω–∞—à–∞ –Ω–∏—à–∞        | –†–∞—Å–ø–∞–∫–æ–≤–∫–∞!A3    |
   | –∞–Ω–∞–ª–∏–∑ –æ—Ç–∑—ã–≤–æ–≤   | –û—Ç–∑—ã–≤—ã!C2        |
   | –∞–Ω–∞–ª–∏–∑ –ø–æ—Å—Ç–æ–≤    | –ü–æ—Å—Ç—ã!K2         |
   ```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:**

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç: `–ü—Ä–æ–º–ø—Ç: –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –Ω–∞—à–∞ –Ω–∏—à–∞`
2. –¢—Ä–∏–≥–≥–µ—Ä –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ
3. –ü—Ä–∏–º–µ–Ω—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –∑–∞–º–µ–Ω—ã:
   - "–Ω–∞—à–∞ –Ω–∏—à–∞" ‚Üí `–†–∞—Å–ø–∞–∫–æ–≤–∫–∞!A3`
4. –°–æ–∑–¥–∞–µ—Ç —Ñ–æ—Ä–º—É–ª—É: `=GM("–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π " & –†–∞—Å–ø–∞–∫–æ–≤–∫–∞!A3)`
5. –ó–∞–º–µ–Ω—è–µ—Ç —Ç–µ–∫—Å—Ç –Ω–∞ —Ñ–æ—Ä–º—É–ª—É

**–°—Ç–∞—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã:**
```
–ü—Ä–æ–º–ø—Ç —Å—Ç–∞—Ç–∏—á–Ω—ã–π: –°–æ–∑–¥–∞–π –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
‚Üí =GM_STATIC("–°–æ–∑–¥–∞–π –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ")
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ª–∏—Å—Ç "–ü—Ä–∞–≤–∏–ª–∞"
2. –î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞/—Ñ—Ä–∞–∑—ã –≤ –∫–æ–ª–æ–Ω–∫—É A
3. –£–∫–∞–∂–∏—Ç–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —è—á–µ–π–∫–∏ –≤ –∫–æ–ª–æ–Ω–∫—É B
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ –ø—Ä–æ–º–ø—Ç–∞—Ö!

---

#### `openWebInterface()`
**–û—Ç–∫—Ä—ã—Ç–∏–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ Table AI**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –°–æ–∑–¥–∞–µ—Ç HTML –∏–∑ —Ñ–∞–π–ª–∞ `web/index.html`
2. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ 800x600px
3. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å:
   - Dashboard
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
   - –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π

**–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–∑–≤–æ–ª—è–µ—Ç:**
- –í–∏–∑—É–∞–ª—å–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–∏—Ü–µ–Ω–∑–∏–µ–π
- –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

---

### OCR Functions

#### `ocrReviews()`
**OCR –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–∑—ã–≤–æ–≤ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª–∏—Å—Ç–æ–º "–û—Ç–∑—ã–≤—ã")

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

**1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:**
- –ù–∞—Ö–æ–¥–∏—Ç –ª–∏—Å—Ç "–û—Ç–∑—ã–≤—ã" / "Reviews"
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É OCR_OVERWRITE (–ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –ª–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ)

**2. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ (–Ω–∞—á–∏–Ω–∞—è —Å 2):**
- –ß–∏—Ç–∞–µ—Ç —è—á–µ–π–∫—É A (–∏—Å—Ç–æ—á–Ω–∏–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
- –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç –µ—Å–ª–∏ –ø—É—Å—Ç–∞—è
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç B (—Ä–µ–∑—É–ª—å—Ç–∞—Ç) - –µ—Å–ª–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω –∏ overwrite=false, –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç metadata —è—á–µ–π–∫–∏:
  - Formula (–µ—Å–ª–∏ –µ—Å—Ç—å IMAGE())
  - Rich text links (–µ—Å–ª–∏ –≤—Å—Ç–∞–≤–ª–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ)

**3. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:**

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:**

a) **–§–æ—Ä–º—É–ª–∞ IMAGE():**
```javascript
=IMAGE("https://example.com/image.jpg")
‚Üí –ò–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è URL –∏–∑ —Ñ–æ—Ä–º—É–ª—ã
```

b) **Rich Text —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º:**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å—Ç–∞–≤–∏–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–ø–∏–ø–∞—Å—Ç–æ–º
‚Üí –ò–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è URL –∏–∑ richText.getLinkUrl()
```

c) **–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞:**
```
https://vk.com/photo123_456
‚Üí –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é
```

d) **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ CDN:**
- VK: `sun*-*.userapi.com`, `vk.com/photo`
- Yandex.Disk: `downloader.disk.yandex.ru`
- Dropbox: `dl.dropboxusercontent.com`
- Google Drive: `drive.google.com/uc?id=`

**4. OCR –æ–±—Ä–∞–±–æ—Ç–∫–∞:**
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É:
  ```javascript
  {
    action: 'ocr_process',
    email: credentials.email,
    token: credentials.token,
    geminiApiKey: credentials.apiKey,
    cellData: displayValue,
    cellMeta: {formula, richTextUrl},
    options: {limit: 50, language: 'ru'}
  }
  ```
- –°–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Gemini Vision API –¥–ª—è OCR
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤

**5. –ó–∞–ø–∏—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:**
- –ï—Å–ª–∏ 1 —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Üí –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ B
- –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ ‚Üí –≤—Å—Ç–∞–≤–ª—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ

**6. –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
```
OCR Complete:
Processed: 15
Skipped: 3
Errors: 2
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏:**
```javascript
// –í Script Properties
OCR_OVERWRITE = "true"  // –ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ
OCR_OVERWRITE = "false" // –ü—Ä–æ–ø—É—Å–∫–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
```

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

1. –°–æ–∑–¥–∞–π—Ç–µ –ª–∏—Å—Ç "–û—Ç–∑—ã–≤—ã"
2. –í –∫–æ–ª–æ–Ω–∫—É A –¥–æ–±–∞–≤—å—Ç–µ:
   - –°—Å—ã–ª–∫–∏ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
   - –§–æ—Ä–º—É–ª—ã IMAGE()
   - –í—Å—Ç–∞–≤—å—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞–ø—Ä—è–º—É—é
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: –ú–µ–Ω—é ‚Üí üí¨ –ê–Ω–∞–ª–∏–∑ –æ—Ç–∑—ã–≤–æ–≤
4. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –≤ –∫–æ–ª–æ–Ω–∫–µ B

---

## üñ•Ô∏è –°–µ—Ä–≤–µ—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (Server)

### API Endpoints

#### `doPost(e)`
**–ì–ª–∞–≤–Ω—ã–π API endpoint –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ POST –∑–∞–ø—Ä–æ—Å–æ–≤**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `e` - –æ–±—ä–µ–∫—Ç —Å–æ–±—ã—Ç–∏—è –æ—Ç Google Apps Script

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

1. **–ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–∞:**
```javascript
var data = JSON.parse(e.postData.contents);
// –û–∂–∏–¥–∞–µ–º—ã–µ –ø–æ–ª—è:
// - action: —Ç–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏
// - email: email –ª–∏—Ü–µ–Ω–∑–∏–∏
// - token: —Ç–æ–∫–µ–Ω –ª–∏—Ü–µ–Ω–∑–∏–∏
// - ...–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è credentials:**
```javascript
if (!data.email || !data.token) {
  return errorResponse('Missing credentials');
}
```

3. **–†–æ—É—Ç–∏–Ω–≥ –ø–æ action:**
```javascript
switch(data.action) {
  case 'social_import':
    return handleSocialImport(data);
  case 'ocr_process':
    return handleOcrProcess(data);
  case 'check_license':
    return handleLicenseCheck(data);
  case 'gm':
    return handleGeminiRequest(data);
  default:
    return errorResponse('Unknown action');
}
```

4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- Try-catch –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
- User-friendly error messages
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –¢—Ä–µ–π—Å–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤

**–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:**
```javascript
// –£—Å–ø–µ—Ö
{
  ok: true,
  data: {...},
  traceId: 'req-123456',
  platform: 'instagram' // –¥–ª—è social_import
}

// –û—à–∏–±–∫–∞  
{
  ok: false,
  error: 'User-friendly error message',
  details: 'Technical details',
  traceId: 'req-123456'
}
```

---

#### `doGet(e)`
**Health check endpoint**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `e` - –æ–±—ä–µ–∫—Ç —Å–æ–±—ã—Ç–∏—è

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
2. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã:
```javascript
{
  status: 'healthy',
  version: '2.0',
  timestamp: new Date().toISOString(),
  services: {
    socialImport: 'ok',
    ocr: 'ok',
    gemini: 'ok',
    license: 'ok'
  }
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
curl https://script.google.com/macros/s/YOUR_ID/exec
```

---

### Smart Chain Services

#### `prepareChainSmart()`
**–£–º–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ü–µ–ø–æ—á–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
```javascript
var promptBox = ss.getSheetByName('Prompt_box');
if (promptBox && hasTargets(promptBox)) {
  prepareChainFromPromptBox();
} else {
  prepareChainForA3();
}
```

2. **–†–µ–∂–∏–º A: Prompt_box (–≥–∏–±–∫–∏–π):**
- –ß–∏—Ç–∞–µ—Ç —Ü–µ–ª–∏ –∏–∑ Prompt_box!B (B2, B3, B4...)
- –ö–∞–∂–¥–∞—è —è—á–µ–π–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç A1 notation —Ü–µ–ª–µ–≤–æ–π —è—á–µ–π–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä "C5")
- –ß–∏—Ç–∞–µ—Ç –ø—Ä–æ–º–ø—Ç—ã –∏–∑ Prompt_box!F (F2, F3, F4...)
- –°–æ–∑–¥–∞–µ—Ç —Ñ–æ—Ä–º—É–ª—ã —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏:
  ```javascript
  // –ü–µ—Ä–≤–∞—è —è—á–µ–π–∫–∞ - –∑–∞–≤–∏—Å–∏—Ç –æ—Ç A3
  =GM_IF($A3<>"", Prompt_box!$F$2, 25000, 0.7)
  
  // –í—Ç–æ—Ä–∞—è - –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ñ—Ä–∞–∑—ã –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –≤ –ø–µ—Ä–≤–æ–π
  =GM_IF(LEFT(B3,LEN("–û—Ç—á—ë—Ç –≥–æ—Ç–æ–≤"))="–û—Ç—á—ë—Ç –≥–æ—Ç–æ–≤", Prompt_box!$F$3, 25000, 0.7)
  ```

3. **–†–µ–∂–∏–º B: –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ A3‚ÜíB3‚Üí...‚ÜíG3:**
- –Ø–∫–æ—Ä—å: A3 –∑–∞–ø–æ–ª–Ω–µ–Ω
- –§–æ—Ä–º—É–ª—ã: B3, C3, D3, E3, F3, G3
- –ö–∞–∂–¥–∞—è —Å–ª–µ–¥—É—é—â–∞—è –∂–¥–µ—Ç —Ñ—Ä–∞–∑—É –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π
- –ü—Ä–æ–º–ø—Ç—ã –∏–∑ Prompt_box!F2, F3, F4, F5, F6, F7

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Prompt_box:**
- –ì–∏–±–∫–∏–µ —Ü–µ–ª–∏ (–º–æ–∂–Ω–æ –≤ –ª—é–±—ã–µ —è—á–µ–π–∫–∏)
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞–º–∏
- –õ–µ–≥–∫–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ü–µ–ø–æ—á–∫–∏:**
- –ü—Ä–æ—Å—Ç–æ—Ç–∞
- –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å
- –ú–µ–Ω—å—à–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

---

#### `prepareChainForA3()`
**–°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ü–µ–ø–æ—á–∫–∏ A3‚ÜíB3‚Üí...‚ÜíG3**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

1. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ü–µ–ø–æ—á–∫–∏:**
```javascript
A3: –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Ç—Ä–∏–≥–≥–µ—Ä)
‚Üì
B3: =GM_IF($A3<>"", Prompt_box!$F$2, 25000, 0.7)
‚Üì (–∂–¥–µ–º "–û—Ç—á—ë—Ç –≥–æ—Ç–æ–≤")
C3: =GM_IF(LEFT(B3,LEN("–û—Ç—á—ë—Ç –≥–æ—Ç–æ–≤"))="–û—Ç—á—ë—Ç –≥–æ—Ç–æ–≤", Prompt_box!$F$3, ...)
‚Üì (–∂–¥–µ–º "–û—Ç—á—ë—Ç –≥–æ—Ç–æ–≤")
D3: =GM_IF(LEFT(C3,LEN("–û—Ç—á—ë—Ç –≥–æ—Ç–æ–≤"))="–û—Ç—á—ë—Ç –≥–æ—Ç–æ–≤", Prompt_box!$F$4, ...)
‚Üì
E3, F3, G3: –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ
```

2. **–ê–ª–≥–æ—Ä–∏—Ç–º:**
```javascript
var phrase = getCompletionPhrase() || COMPLETION_PHRASE;
var phraseEscaped = phrase.replace(/"/g, '""');

var formulas = [
  // B3 - –∑–∞–≤–∏—Å–∏—Ç –æ—Ç A3
  '=GM_IF($A3<>"", Prompt_box!$F$2, 25000, 0.7)',
  
  // C3 - –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ B3
  '=GM_IF(LEFT(B3,LEN("' + phraseEscaped + '"))="' + phraseEscaped + '", Prompt_box!$F$3, 25000, 0.7)',
  
  // D3-G3: –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ
  // ...
];

for (var i = 0; i < formulas.length; i++) {
  sheet.getRange(3, i + 2).setFormula(formulas[i]); // –ö–æ–ª–æ–Ω–∫–∏ B-G (2-7)
}
```

3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Prompt_box:**
```
| A | B           | C | D | E | F (–ø—Ä–æ–º–ø—Ç—ã)                          |
|---|-------------|---|---|---|--------------------------------------|
| 1 | (–∑–∞–≥–æ–ª–æ–≤–æ–∫) | . | . | . | (–∑–∞–≥–æ–ª–æ–≤–æ–∫)                          |
| 2 | B3          | . | . | . | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏–∑ A3        |
| 3 | C3          | . | . | . | –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ B3      |
| 4 | D3          | . | . | . | –°–æ–∑–¥–∞–Ω–∏–µ –≤—ã–≤–æ–¥–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ C3        |
| 5 | E3          | . | . | . | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º D3       |
| 6 | F3          | . | . | . | –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç —Å–æ –≤—Å–µ–º–∏ –¥–∞–Ω–Ω—ã–º–∏    |
| 7 | G3          | . | . | . | –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –¥–ª—è —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞       |
```

**–ö–æ–≥–¥–∞ —Ü–µ–ø–æ—á–∫–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç A3
2. B3 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è (—É—Å–ª–æ–≤–∏–µ `$A3<>""`)
3. Gemini –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–≤–µ—Ç –Ω–∞—á–∏–Ω–∞—è —Å "–û—Ç—á—ë—Ç –≥–æ—Ç–æ–≤: ..."
4. C3 –≤–∏–¥–∏—Ç —Ñ—Ä–∞–∑—É –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
5. –ò —Ç–∞–∫ –¥–∞–ª–µ–µ –¥–æ G3

**–†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫:**
–ú–µ–Ω—é ‚Üí üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑

---

## üîó –û–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ (Shared)

### Logging

#### `addSystemLog(message, level, tag)`
**–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `message` (string) - —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
- `level` (string) - —É—Ä–æ–≤–µ–Ω—å: DEBUG, INFO, WARN, ERROR, CRITICAL
- `tag` (string) - –∫–∞—Ç–µ–≥–æ—Ä–∏—è: GEMINI, VK_IMPORT, OCR, LICENSE, SYSTEM

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

1. **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –ª–æ–≥–∞:**
```javascript
var logEntry = {
  timestamp: Utilities.formatDate(new Date(), 'Europe/Moscow', 'yyyy-MM-dd HH:mm:ss'),
  level: level,
  tag: tag,
  message: message,
  traceId: getCurrentTraceId() // –î–ª—è —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
};
```

2. **–•—Ä–∞–Ω–µ–Ω–∏–µ (–º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ):**

**Level 1: ScriptCache (–±—ã—Å—Ç—Ä—ã–π, 5 –º–∏–Ω):**
```javascript
var cache = CacheService.getScriptCache();
var logs = JSON.parse(cache.get(LOGS_CACHE_KEY) || '[]');
logs.push(logEntry);
if (logs.length > MAX_LOGS) logs.shift(); // –†–æ—Ç–∞—Ü–∏—è
cache.put(LOGS_CACHE_KEY, JSON.stringify(logs), LOGS_TTL);
```

**Level 2: Console (–¥–ª—è debugging):**
```javascript
console.log('[' + level + '] [' + tag + '] ' + message);
```

**Level 3: Properties (–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—à–∏–±–æ–∫):**
```javascript
if (level === 'ERROR' || level === 'CRITICAL') {
  PropertiesService.getScriptProperties().setProperty(
    'last_error_' + Date.now(),
    JSON.stringify(logEntry)
  );
}
```

3. **–£—Ä–æ–≤–Ω–∏ –≤–∞–∂–Ω–æ—Å—Ç–∏:**
- `DEBUG` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- `INFO` - –æ–±—ã—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `WARN` - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
- `ERROR` - –æ—à–∏–±–∫–∏ (—Ç—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è)
- `CRITICAL` - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–±–æ–∏ (—Å–∏—Å—Ç–µ–º–∞ –Ω–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–∞)

**–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```javascript
addSystemLog('‚Üí GM: prompt=123', 'INFO', 'GEMINI');
addSystemLog('‚úÖ OCR success: row=5', 'INFO', 'OCR');
addSystemLog('‚ö†Ô∏è Rate limit approaching', 'WARN', 'LICENSE');
addSystemLog('‚ùå VK API failed', 'ERROR', 'VK_IMPORT');
addSystemLog('üö® Database corrupted', 'CRITICAL', 'SYSTEM');
```

---

#### `getLogs(limit)`
**–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `limit` (number, optional) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–æ–≥–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 50)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** string - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
```javascript
var cache = CacheService.getScriptCache();
var logs = JSON.parse(cache.get(LOGS_CACHE_KEY) || '[]');
var recent = logs.slice(-limit);

return recent.map(function(entry) {
  return '[' + entry.timestamp + '] ' + entry.level + ' [' + entry.tag + ']: ' + entry.message;
}).join('\\n');
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```javascript
var last20 = getLogs(20);
console.log(last20);
```

---

#### `exportSystemLogsToSheet()`
**–≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤ –≤ –ª–∏—Å—Ç "–õ–æ–≥–∏"**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

1. –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –ª–æ–≥–∏ –∏–∑ –∫—ç—à–∞
2. –°–æ–∑–¥–∞–µ—Ç/–æ—á–∏—â–∞–µ—Ç –ª–∏—Å—Ç "–õ–æ–≥–∏"
3. –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏:
```
| –í—Ä–µ–º—è              | –£—Ä–æ–≤–µ–Ω—å | –¢–µ–≥      | –°–æ–æ–±—â–µ–Ω–∏–µ           |
|--------------------|---------|----------|---------------------|
| 2025-10-08 12:30:45| INFO    | GEMINI   | ‚Üí GM: prompt=...    |
| 2025-10-08 12:30:47| ERROR   | VK_IMPORT| ‚ùå VK API failed     |
```
4. –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç (–∂–∏—Ä–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏, –∞–≤—Ç–æ—à–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫)
5. –¶–≤–µ—Ç–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —É—Ä–æ–≤–Ω—é:
   - DEBUG: —Å–µ—Ä—ã–π
   - INFO: –±–µ–ª—ã–π
   - WARN: –∂–µ–ª—Ç—ã–π
   - ERROR: –æ—Ä–∞–Ω–∂–µ–≤—ã–π
   - CRITICAL: –∫—Ä–∞—Å–Ω—ã–π

---

### Markdown Processing

#### `processGeminiResponse(response)`
**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ Markdown –≤ —É–¥–æ–±–æ—á–∏—Ç–∞–µ–º—ã–π —Ç–µ–∫—Å—Ç**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `response` (string) - –æ—Ç–≤–µ—Ç –æ—Ç Gemini

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** string - –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è Markdown:**
```javascript
function isMarkdownText(text) {
  var patterns = [
    /\\*\\*[^*]+\\*\\*/,    // **bold**
    /\\*[^*]+\\*/,        // *italic*
    /^#{1,6}\\s+/m,     // # headers
    /^[-*+]\\s+/m,      // - lists
    /\\[.+\\]\\(.+\\)/,   // [links](url)
    /```[\\s\\S]*?```/, // ```code```
    /`[^`]+`/           // `inline`
  ];
  return patterns.some(p => p.test(text));
}
```

2. **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è:**

**–ë–ª–æ–∫–∏ –∫–æ–¥–∞:**
```javascript
// ```javascript\ncode\n``` ‚Üí \ncode\n
text = text.replace(/```[\\w]*\\n?([\\s\\S]*?)\\n?```/g, function(match, code) {
  return '\\n' + code.trim() + '\\n';
});
```

**–ò–Ω–ª–∞–π–Ω –∫–æ–¥:**
```javascript
// `code` ‚Üí code
text = text.replace(/`([^`]+)`/g, '$1');
```

**–ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç:**
```javascript
// **text** ‚Üí TEXT (–ó–ê–ì–õ–ê–í–ù–´–ú–ò)
text = text.replace(/\\*\\*([^*]+)\\*\\*/g, function(match, content) {
  return content.toUpperCase();
});
```

**–ö—É—Ä—Å–∏–≤:**
```javascript
// *text* ‚Üí text (—É–±–∏—Ä–∞–µ–º –∑–≤–µ–∑–¥–æ—á–∫–∏)
text = text.replace(/\\*([^*]+)\\*/g, '$1');
```

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
```javascript
// # Header ‚Üí HEADER:
text = text.replace(/^#{1,6}\\s+(.+)$/gm, function(match, heading) {
  return '\\n' + heading.toUpperCase() + ':\\n';
});
```

**–°–ø–∏—Å–∫–∏:**
```javascript
// - item ‚Üí 1. item (–Ω—É–º–µ—Ä–∞—Ü–∏—è)
var lines = text.split('\\n');
var listCounter = 0;
lines = lines.map(function(line) {
  if (line.trim().match(/^[-*+]\\s+/)) {
    listCounter++;
    return line.replace(/^(\\s*)[-*+]\\s+/, '$1' + listCounter + '. ');
  }
  return line;
});
text = lines.join('\\n');
```

**–°—Å—ã–ª–∫–∏:**
```javascript
// [text](url) ‚Üí text
text = text.replace(/\\[([^\\]]+)\\]\\([^)]+\\)/g, '$1');
```

3. **–û—á–∏—Å—Ç–∫–∞:**
```javascript
// –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø–µ—Ä–µ–Ω–æ—Å—ã (–±–æ–ª—å—à–µ 2 –ø–æ–¥—Ä—è–¥)
text = text.replace(/\\n{3,}/g, '\\n\\n');

// Trim
text = text.trim();
```

**–ü—Ä–∏–º–µ—Ä:**

**–î–æ:**
```markdown
# –û—Ç—á—ë—Ç –≥–æ—Ç–æ–≤

## –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

**–û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã:**
- –ú–µ—Ç—Ä–∏–∫–∞ A: `+25%`
- –ú–µ—Ç—Ä–∏–∫–∞ B: *—Å–Ω–∏–∂–µ–Ω–∏–µ*

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
1. –£–≤–µ–ª–∏—á–∏—Ç—å **–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏**
2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å

[–ü–æ–¥—Ä–æ–±–Ω–µ–µ](https://example.com)
```

**–ü–æ—Å–ª–µ:**
```
–û–¢–ß–Å–¢ –ì–û–¢–û–í:

–ê–ù–ê–õ–ò–ó –î–ê–ù–ù–´–•:

–û–°–ù–û–í–ù–´–ï –í–´–í–û–î–´:
1. –ú–µ—Ç—Ä–∏–∫–∞ A: +25%
2. –ú–µ—Ç—Ä–∏–∫–∞ B: —Å–Ω–∏–∂–µ–Ω–∏–µ

–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:
1. –£–≤–µ–ª–∏—á–∏—Ç—å –ò–ù–í–ï–°–¢–ò–¶–ò–ò
2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å

–ü–æ–¥—Ä–æ–±–Ω–µ–µ
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- –í—Å–µ GM —Ñ—É–Ω–∫—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç `processGeminiResponse()`
- OCR —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–∞–∫–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
- –ú–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫—É `DISABLE_MARKDOWN_PROCESSING`

---

### A1 Notation Helpers

#### `parseTargetA1(a1String)`
**–ü–∞—Ä—Å–∏–Ω–≥ A1 notation –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `a1String` (string) - A1 notation (–Ω–∞–ø—Ä–∏–º–µ—Ä "C5", "AA10")

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```javascript
{
  row: number,    // –ù–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ (1-based)
  col: number,    // –ù–æ–º–µ—Ä –∫–æ–ª–æ–Ω–∫–∏ (1-based)
  a1: string,     // –ò—Å—Ö–æ–¥–Ω–∞—è A1 notation —Å $ –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏
  colLetter: string // –ë—É–∫–≤–∞ –∫–æ–ª–æ–Ω–∫–∏
}
```

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
```javascript
// –ü—Ä–∏–º–µ—Ä—ã: "C5" ‚Üí {row:5, col:3, a1:"$C$5", colLetter:"C"}
//          "AA10" ‚Üí {row:10, col:27, a1:"$AA$10", colLetter:"AA"}

var match = a1String.match(/^([A-Z]+)(\\d+)$/);
if (!match) throw new Error('Invalid A1 notation: ' + a1String);

var colLetter = match[1];
var row = parseInt(match[2]);
var col = letterToColumn(colLetter);

return {
  row: row,
  col: col,
  a1: '$' + colLetter + '$' + row,
  colLetter: colLetter
};
```

---

#### `columnToLetter(columnNumber)`
**–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –∫–æ–ª–æ–Ω–∫–∏ –≤ –±—É–∫–≤—É**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `columnNumber` (number) - –Ω–æ–º–µ—Ä –∫–æ–ª–æ–Ω–∫–∏ (1-based)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** string - –±—É–∫–≤–µ–Ω–Ω–æ–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
```javascript
// 1‚ÜíA, 2‚ÜíB, ..., 26‚ÜíZ, 27‚ÜíAA, 28‚ÜíAB, ...

var letter = '';
while (columnNumber > 0) {
  var remainder = (columnNumber - 1) % 26;
  letter = String.fromCharCode(65 + remainder) + letter;
  columnNumber = Math.floor((columnNumber - 1) / 26);
}
return letter;
```

**–ü—Ä–∏–º–µ—Ä—ã:**
```javascript
columnToLetter(1)   // "A"
columnToLetter(26)  // "Z"
columnToLetter(27)  // "AA"
columnToLetter(702) // "ZZ"
columnToLetter(703) // "AAA"
```

---

#### `letterToColumn(columnLetter)`
**–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –±—É–∫–≤—ã –∫–æ–ª–æ–Ω–∫–∏ –≤ –Ω–æ–º–µ—Ä**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `columnLetter` (string) - –±—É–∫–≤–µ–Ω–Ω–æ–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** number - –Ω–æ–º–µ—Ä –∫–æ–ª–æ–Ω–∫–∏ (1-based)

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
```javascript
// A‚Üí1, B‚Üí2, ..., Z‚Üí26, AA‚Üí27, AB‚Üí28, ...

var column = 0;
for (var i = 0; i < columnLetter.length; i++) {
  column = column * 26 + (columnLetter.charCodeAt(i) - 64);
}
return column;
```

**–ü—Ä–∏–º–µ—Ä—ã:**
```javascript
letterToColumn("A")    // 1
letterToColumn("Z")    // 26
letterToColumn("AA")   // 27
letterToColumn("ZZ")   // 702
letterToColumn("AAA")  // 703
```

---

## üìä –ü–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Ñ—É–Ω–∫—Ü–∏–π

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ                       ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ   –ú–ï–ù–Æ   ‚îÇ          ‚îÇ  –§–û–†–ú–£–õ–´   ‚îÇ
    ‚îÇ (Menu.gs)‚îÇ          ‚îÇ  –í –Ø–ß–ï–ô–ö–ê–• ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                      ‚îÇ
         ‚îÇ     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ     ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ              –ö–õ–ò–ï–ù–¢–°–ö–ò–ï –§–£–ù–ö–¶–ò–ò                         ‚îÇ
    ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
    ‚îÇ  ‚îÇ GM Functions (GeminiClient.gs)                   ‚îÇ   ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ GM() - –æ—Å–Ω–æ–≤–Ω–æ–π –≤—ã–∑–æ–≤ Gemini                  ‚îÇ   ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ GM_STATIC() - —Å –∞–≤—Ç–æ–∑–∞–º–µ–Ω–æ–π –Ω–∞ —Å—Ç–∞—Ç–∏–∫—É        ‚îÇ   ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ GM_IF() - —É—Å–ª–æ–≤–Ω—ã–π –≤—ã–∑–æ–≤                      ‚îÇ   ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ GM_IF_STATIC() - —É—Å–ª–æ–≤–Ω—ã–π —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π         ‚îÇ   ‚îÇ
    ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
    ‚îÇ               ‚îÇ                                          ‚îÇ
    ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
    ‚îÇ  ‚îÇ Utilities (ClientUtilities.gs)                   ‚îÇ   ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ Caching (gmCacheKey_, gmCacheGet_)            ‚îÇ   ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ Markdown Processing (processGeminiResponse)   ‚îÇ   ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ License Management (checkLicenseStatusUI)     ‚îÇ   ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ Smart Prompts (setupSmartPromptTrigger)       ‚îÇ   ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ Chat Mode (initializeChatMode)                ‚îÇ   ‚îÇ
    ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
    ‚îÇ               ‚îÇ                                          ‚îÇ
    ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
    ‚îÇ  ‚îÇ ThinClient (ThinClient.gs)                       ‚îÇ   ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ callServer() - HTTP client                    ‚îÇ   ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ ocrReviewsThin() - OCR proxy                  ‚îÇ   ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ importVkPostsThin() - VK proxy                ‚îÇ   ‚îÇ
    ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ HTTPS POST
                           ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ              –°–ï–†–í–ï–†–ù–´–ï –§–£–ù–ö–¶–ò–ò                           ‚îÇ
    ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
    ‚îÇ  ‚îÇ API Gateway (ServerEndpoints.gs)                 ‚îÇ    ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ doPost() - routing                            ‚îÇ    ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ doGet() - health check                        ‚îÇ    ‚îÇ
    ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
    ‚îÇ               ‚îÇ                                           ‚îÇ
    ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
    ‚îÇ  ‚îÇ Social Import (SocialImportService.gs)           ‚îÇ    ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ importSocialPosts()                           ‚îÇ    ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ Instagram/VK/Telegram handlers                ‚îÇ    ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ Retry logic (RetryService.gs)                 ‚îÇ    ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ Validation (ValidationService.gs)             ‚îÇ    ‚îÇ
    ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
    ‚îÇ               ‚îÇ                                           ‚îÇ
    ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
    ‚îÇ  ‚îÇ OCR Service (OcrService.gs)                      ‚îÇ    ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ processOcrBatch()                             ‚îÇ    ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ Gemini Vision API integration                 ‚îÇ    ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ Source detection (SourceDetector.gs)          ‚îÇ    ‚îÇ
    ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
    ‚îÇ               ‚îÇ                                           ‚îÇ
    ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
    ‚îÇ  ‚îÇ License Service (LicenseService.gs)              ‚îÇ    ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ validateLicense()                             ‚îÇ    ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ checkRateLimit()                              ‚îÇ    ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ trackUsage()                                  ‚îÇ    ‚îÇ
    ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
    ‚îÇ               ‚îÇ                                           ‚îÇ
    ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
    ‚îÇ  ‚îÇ Smart Chains (SmartChainService.gs)              ‚îÇ    ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ prepareChainSmart()                           ‚îÇ    ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ prepareChainForA3()                           ‚îÇ    ‚îÇ
    ‚îÇ  ‚îÇ  ‚Ä¢ prepareChainFromPromptBox()                   ‚îÇ    ‚îÇ
    ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           ‚ñº
                    –í–ù–ï–®–ù–ò–ï API:
                    ‚Ä¢ Gemini AI API
                    ‚Ä¢ Instagram API
                    ‚Ä¢ VK API
                    ‚Ä¢ Telegram RSS/Web
```

---

## üéØ –ö—Ä–∞—Ç–∫–∏–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å Gemini:
```javascript
// –ü—Ä–æ—Å—Ç–æ–π –≤—ã–∑–æ–≤
=GM("–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –¥–∞–Ω–Ω—ã–µ: " & A2)

// –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π (–±–µ–∑ –ø–µ—Ä–µ—Å—á–µ—Ç–∞)
=GM_STATIC("–°–æ–∑–¥–∞–π –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞")

// –£—Å–ª–æ–≤–Ω—ã–π
=GM_IF(A2<>"", "–û–±—Ä–∞–±–æ—Ç–∞–π: " & A2)
```

### –ò–º–ø–æ—Ä—Ç –∏–∑ —Å–æ—Ü—Å–µ—Ç–µ–π:
1. –°–æ–∑–¥–∞–π—Ç–µ –ª–∏—Å—Ç "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã"
2. B1: URL –∏—Å—Ç–æ—á–Ω–∏–∫–∞
3. B2: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤
4. –ú–µ–Ω—é ‚Üí –ò–º–ø–æ—Ä—Ç –ø–æ—Å—Ç–æ–≤

### OCR –æ—Ç–∑—ã–≤–æ–≤:
1. –°–æ–∑–¥–∞–π—Ç–µ –ª–∏—Å—Ç "–û—Ç–∑—ã–≤—ã"
2. –í –∫–æ–ª–æ–Ω–∫—É A: —Å—Å—ã–ª–∫–∏/IMAGE()/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
3. –ú–µ–Ω—é ‚Üí –ê–Ω–∞–ª–∏–∑ –æ—Ç–∑—ã–≤–æ–≤

### –£–º–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏:
1. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ Prompt_box (–ø—Ä–æ–º–ø—Ç—ã –≤ F2-F7)
2. –ú–µ–Ω—é ‚Üí –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ A3 ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ B3‚ÜíC3‚Üí...‚ÜíG3

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 2.0  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-10-08  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready

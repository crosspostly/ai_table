# üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ VK —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

## üìä **–¢–ï–ö–£–©–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê VK**

### **üîÑ –ü—É—Ç—å –∑–∞–ø—Ä–æ—Å–∞:**
```
1. üíª –ö–õ–ò–ï–ù–¢ (Google Sheets)
   ‚Üì ThinClient.gs ‚Üí importVkPostsThin() 
   ‚Üì callServer() ‚Üí SERVER_URL

2. üñ•Ô∏è –û–°–ù–û–í–ù–û–ô –°–ï–†–í–ï–† (Main API Server)
   ‚Üì ServerEndpoints.gs ‚Üí handleVkImport()
   ‚Üì DataCollectors.gs ‚Üí VkCollector.collect()
   ‚Üì UrlFetchApp.fetch() ‚Üí VK_PARSER_URL

3. üîß VK_PARSER (–û—Ç–¥–µ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
   ‚Üì handleWallGet_() 
   ‚Üì VK API –ø—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å
   ‚Üì –í–æ–∑–≤—Ä–∞—Ç JSON –º–∞—Å—Å–∏–≤–∞ –ø–æ—Å—Ç–æ–≤
```

---

## üìÅ **–§–ê–ô–õ–´ –ò –§–£–ù–ö–¶–ò–ò**

### **üìç –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å:**
- **`table/client/ThinClient.gs`**
  - `importVkPostsThin()` - –∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è
  - `getVkImportParams()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ Sheets
  - `writeVkPosts()` - –∑–∞–ø–∏—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –ª–∏—Å—Ç "–ø–æ—Å—Ç—ã"

### **üìç –°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å (–û–°–ù–û–í–ù–û–ô –°–ï–†–í–ï–†):**
- **`table/server/ServerEndpoints.gs`**
  - `handleVkImport()` - API —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è VK
  
- **`table/server/DataCollectors.gs`**  
  - `VkCollector.collect()` - –∫–æ–ª–ª–µ–∫—Ç–æ—Ä VK –¥–∞–Ω–Ω—ã—Ö
  - `getVkParserBaseUrl()` - –ø–æ–ª—É—á–µ–Ω–∏–µ URL VK –ø–∞—Ä—Å–µ—Ä–∞

- **`table/server/VkImportService.gs`**
  - `importVkPosts()` - –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–º–ø–æ—Ä—Ç–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
  - `createStopWordsFormulas()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–æ—Ä–º—É–ª —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
  - `testStopWordsFilter()` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤

### **üìç –í–Ω–µ—à–Ω–∏–π VK_PARSER (–û–¢–î–ï–õ–¨–ù–û–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–ï):**
```javascript
// –≠—Ç–æ –í–ê–® –∫–æ–¥ VK –ø–∞—Ä—Å–µ—Ä–∞:
- handleWallGet_() - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤ —Å–æ —Å—Ç–µ–Ω—ã
- handleParseAlbum_() - –ø–∞—Ä—Å–∏–Ω–≥ —Ñ–æ—Ç–æ –∞–ª—å–±–æ–º–æ–≤
- handleParseDiscussion_() - –ø–∞—Ä—Å–∏–Ω–≥ –æ–±—Å—É–∂–¥–µ–Ω–∏–π 
- handleParseReviews_() - –ø–∞—Ä—Å–∏–Ω–≥ –æ—Ç–∑—ã–≤–æ–≤
- getVkToken_() - –ø–æ–ª—É—á–µ–Ω–∏–µ VK —Ç–æ–∫–µ–Ω–∞
```

---

## ‚ö° **–ö–õ–Æ–ß–ï–í–´–ï –§–£–ù–ö–¶–ò–ò VK_PARSER**

### **üéØ handleWallGet_() - –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø:**
```javascript
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: owner (ID/domain), count (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
- VK API: wall.get —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ owner_id/domain
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: –º–∞—Å—Å–∏–≤ –ø–æ—Å—Ç–æ–≤ —Å –ø–æ–ª—è–º–∏:
  ‚Ä¢ date - –¥–∞—Ç–∞ –ø–æ—Å—Ç–∞
  ‚Ä¢ link - —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ—Å—Ç  
  ‚Ä¢ text - —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞
  ‚Ä¢ number - –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä
  ‚Ä¢ comments - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
  ‚Ä¢ likes - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∞–π–∫–æ–≤
```

### **üñºÔ∏è handleParseAlbum_() - –ê–õ–¨–ë–û–ú–´:**
```javascript
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: url –∞–ª—å–±–æ–º–∞, limit, offset
- VK API: photos.get
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: {images: [], hasMore: bool, nextOffset: int, total: int}
```

### **üí¨ handleParseDiscussion_() - –û–ë–°–£–ñ–î–ï–ù–ò–Ø:**
```javascript
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: url —Ç–µ–º—ã, limit, offset  
- VK API: board.getComments
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: {texts: [], hasMore: bool, nextOffset: int, total: int}
```

### **‚≠ê handleParseReviews_() - –û–¢–ó–´–í–´:**
```javascript
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: url reviews-—Å—Ç—Ä–∞–Ω–∏—Ü—ã, limit, offset
- VK API: board.getTopics + board.getComments —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: {texts: [], hasMore: bool, nextOffset: int, total: int}
```

---

## üî• **–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–´–ï –û–°–û–ë–ï–ù–ù–û–°–¢–ò**

### **1. VK_TOKEN –≤ Properties:**
- VK_PARSER –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–∫–µ–Ω –∏–∑ `PropertiesService.getScriptProperties().getProperty('VK_TOKEN')`
- –ë–ï–ó —Ç–æ–∫–µ–Ω–∞ –Ω–∏—á–µ–≥–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!

### **2. –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ VkImportService.gs:**
- –°—Ç–æ–ø-—Å–ª–æ–≤–∞ (–∫–æ–ª–æ–Ω–∫–∏ E, F, G)
- –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —Å–ª–æ–≤–∞ (–∫–æ–ª–æ–Ω–∫–∏ H, I, J) 
- –°–ª–æ–∂–Ω—ã–µ Excel —Ñ–æ—Ä–º—É–ª—ã —Å SUMPRODUCT –∏ SEARCH
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω—É–º–µ—Ä–∞—Ü–∏—è –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤

### **3. –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- 11 –∫–æ–ª–æ–Ω–æ–∫ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏
- –¶–≤–µ—Ç–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- –ê–≤—Ç–æ—à–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫
- –§–æ—Ä–º—É–ª—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### **4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Å—Å–∏–≤–∞ –æ—Ç VK_PARSER
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π  
- User-friendly —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

---

## ‚ö†Ô∏è **–†–ò–°–ö–ò –ü–†–ò –ú–ò–ì–†–ê–¶–ò–ò**

### **üö® –í–´–°–û–ö–ò–ô –†–ò–°–ö:**
1. **VK_TOKEN** - –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä
2. **–§–æ—Ä–º—É–ª—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏** - —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å Excel —Ñ–æ—Ä–º—É–ª–∞–º–∏
3. **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** - —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
4. **API –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã** - –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ (wall/album/discussion/reviews)

### **üî∏ –°–†–ï–î–ù–ò–ô –†–ò–°–ö:**
1. **URL –ø–∞—Ä—Å–∏–Ω–≥** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ ID –∏–∑ VK URLs
2. **–ü–∞–≥–∏–Ω–∞—Ü–∏—è** - offset/limit –ª–æ–≥–∏–∫–∞ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤  
3. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏

---

## ‚úÖ **–ü–õ–ê–ù –ë–ï–ó–û–ü–ê–°–ù–û–ô –ú–ò–ì–†–ê–¶–ò–ò**

### **–®–ê–ì 1: –ü–û–î–ì–û–¢–û–í–ö–ê**
1. –°–æ–∑–¥–∞—Ç—å baseline —Ç–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ VK –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â—É—é —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤—Å–µ—Ö 4 —Ñ—É–Ω–∫—Ü–∏–π  
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤

### **–®–ê–ì 2: –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø**
1. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ `getVkToken_()` –≤ VkImportService.gs
2. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `handleWallGet_()` ‚Üí –∑–∞–º–µ–Ω–∏—Ç—å VK_PARSER_URL –≤—ã–∑–æ–≤
3. –î–æ–±–∞–≤–∏—Ç—å `handleParseAlbum_()` –∫–∞–∫ –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é
4. –î–æ–±–∞–≤–∏—Ç—å `handleParseDiscussion_()` –∫–∞–∫ –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é  
5. –î–æ–±–∞–≤–∏—Ç—å `handleParseReviews_()` –∫–∞–∫ –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é

### **–®–ê–ì 3: –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï**
1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—É—é —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç–¥–µ–ª—å–Ω–æ
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É–ª—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏  
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
4. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç

### **–®–ê–ì 4: –û–ß–ò–°–¢–ö–ê**  
1. –£–±—Ä–∞—Ç—å VK_PARSER_URL –∏–∑ Constants.gs
2. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
3. –°–æ–∑–¥–∞—Ç—å Pull Request

---

## üí° **–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø**

**–ù–∞—á–Ω–µ–º —Å handleWallGet_()** - —ç—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è –∏ —Å–∞–º–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è —Ñ—É–Ω–∫—Ü–∏—è.
–ó–∞—Ç–µ–º –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –¥–æ–±–∞–≤–∏–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏.

**–°–æ—Ö—Ä–∞–Ω–∏–º –í–°–ï —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ API –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ** - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ!

–ì–æ—Ç–æ–≤—ã –Ω–∞—á–∏–Ω–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é? üöÄ
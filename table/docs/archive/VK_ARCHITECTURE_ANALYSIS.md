# üîç –ê–Ω–∞–ª–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã VK: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

## üö® **–û–ë–ù–ê–†–£–ñ–ï–ù–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê**

–£ –Ω–∞—Å –µ—Å—Ç—å **–î–£–ë–õ–ò–†–û–í–ê–ù–ò–ï** VK —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:

### **üìç –í–ö —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ:**
- `table/server/VkImportService.gs` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ VK –ø–æ—Å—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- –ù–æ —ç—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å **–°–°–´–õ–ê–ï–¢–°–Ø** –Ω–∞ –≤–Ω–µ—à–Ω–∏–π `VK_PARSER_URL` !

### **üîó –í–Ω–µ—à–Ω–∏–π VK_PARSER (–æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ):**
```
URL: https://script.google.com/macros/s/AKfycbzttbqz16EmmcXbEYCuYhNlXkCxAnCG77phspFL1_rTCi4xVqoorByJAPa4dI4iwT8/exec

–§–£–ù–ö–¶–ò–ò:
‚Ä¢ handleWallGet_() - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤ —Å–æ —Å—Ç–µ–Ω—ã VK
‚Ä¢ handleParseAlbum_() - –ø–∞—Ä—Å–∏–Ω–≥ —Ñ–æ—Ç–æ –∞–ª—å–±–æ–º–æ–≤ 
‚Ä¢ handleParseDiscussion_() - –ø–∞—Ä—Å–∏–Ω–≥ –æ–±—Å—É–∂–¥–µ–Ω–∏–π/—Ç–æ–ø–∏–∫–æ–≤
‚Ä¢ handleParseReviews_() - –ø–∞—Ä—Å–∏–Ω–≥ –æ—Ç–∑—ã–≤–æ–≤
```

---

## ‚ö° **–¢–ï–ö–£–©–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê (–ù–ï–û–ü–¢–ò–ú–ê–õ–¨–ù–ê–Ø)**

```
üíª –ö–õ–ò–ï–ù–¢          üñ•Ô∏è –°–ï–†–í–ï–†                    üîß VK_PARSER
Google Sheets  ‚Üí  Main API Server       ‚Üí     VK —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å
              ThinClient.gs           VkImportService.gs        handleWallGet_()
                                           ‚Üì                      handleParseAlbum_()
                                     UrlFetchApp.fetch()          handleParseDiscussion_()  
                                     VK_PARSER_URL                handleParseReviews_()
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- VkImportService.gs –Ω–µ –¥–µ–ª–∞–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã - —Ç–æ–ª—å–∫–æ –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∫ VK_PARSER_URL
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π HTTP —Ö–æ–ø –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–æ–º –∏ VK –ø–∞—Ä—Å–µ—Ä–æ–º
- –£—Å–ª–æ–∂–Ω–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Ç—Ä–µ—Ö –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö

---

## ‚úÖ **–†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ï –í–ê–†–ò–ê–ù–¢–´ –†–ï–®–ï–ù–ò–Ø**

### **üéØ –í–ê–†–ò–ê–ù–¢ 1: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è VK –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä**
**–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤–µ—Å—å –∫–æ–¥ –∏–∑ VK_PARSER –≤ VkImportService.gs:**

```
üíª –ö–õ–ò–ï–ù–¢          üñ•Ô∏è –°–ï–†–í–ï–† (—Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º VK)
Google Sheets  ‚Üí  Main API Server
              ThinClient.gs           
                    ‚Üì
               ServerEndpoints.gs ‚Üí VkImportService.gs
                                      ‚Üì
                               VK API (–ø—Ä—è–º–æ –∏–∑ —Å–µ—Ä–≤–µ—Ä–∞)
```

**–ü–ª—é—Å—ã:**
- –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (2 –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ 3)
- –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—É–±–∏—Ä–∞–µ–º –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π HTTP —Ö–æ–ø)
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ –∏ –æ—à–∏–±–∫–∏
- –£–±–∏—Ä–∞–µ–º VK_PARSER_URL –∏–∑ Constants.gs

**–ú–∏–Ω—É—Å—ã:**
- –ù—É–∂–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∫–æ–¥ VK —Ç–æ–∫–µ–Ω–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä
- –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è —Ä–∞–∑–º–µ—Ä –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

### **üîß –í–ê–†–ò–ê–ù–¢ 2: –û—Å—Ç–∞–≤–∏—Ç—å VK_PARSER –æ—Ç–¥–µ–ª—å–Ω—ã–º**
**–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –Ω–æ —É–ª—É—á—à–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:**

```
üíª –ö–õ–ò–ï–ù–¢          üñ•Ô∏è –°–ï–†–í–ï–†          üîß VK_PARSER  
Google Sheets  ‚Üí  Main API Server  ‚Üí  VK —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π
```

**–ü–ª—é—Å—ã:**
- –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π VK —Å–µ—Ä–≤–∏—Å
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å VK_PARSER –∏–∑ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
- –ò–∑–æ–ª—è—Ü–∏—è VK —Ç–æ–∫–µ–Ω–æ–≤

**–ú–∏–Ω—É—Å—ã:**
- –¢—Ä–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å–µ—Ç–µ–≤–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
- –£—Å–ª–æ–∂–Ω–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

---

## üí° **–ú–û–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø: –í–ê–†–ò–ê–ù–¢ 1**

**–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å VK –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä** –ø–æ—Ç–æ–º—É —á—Ç–æ:

1. **–£–ø—Ä–æ—â–µ–Ω–∏–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è** - —Ç–æ–ª—å–∫–æ 2 –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ 3
2. **–õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - —É–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–π HTTP —Ö–æ–ø  
3. **–ü—Ä–æ—â–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** - –≤—Å–µ –ª–æ–≥–∏ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
4. **–ú–µ–Ω—å—à–µ —Ç–æ—á–µ–∫ –æ—Ç–∫–∞–∑–∞** - –Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç—Ä–µ—Ç—å–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞

---

## üîß **–ü–õ–ê–ù –ò–ù–¢–ï–ì–†–ê–¶–ò–ò**

–ï—Å–ª–∏ –≤—ã–±–µ—Ä–µ–º –í–ê–†–ò–ê–ù–¢ 1:

1. **–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ VK_PARSER:**
   - `handleWallGet_()` ‚Üí –≤ `VkImportService.gs`
   - `handleParseAlbum_()` ‚Üí –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è
   - `handleParseDiscussion_()` ‚Üí –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è  
   - `handleParseReviews_()` ‚Üí –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å VK_TOKEN –≤ Properties –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞**

3. **–£–±—Ä–∞—Ç—å VK_PARSER_URL** –∏–∑ `Constants.gs`

4. **–û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –≤—ã–∑–æ–≤—ã** VK_PARSER_URL –Ω–∞ –ø—Ä—è–º—ã–µ VK API –≤—ã–∑–æ–≤—ã

5. **–û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é** —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

---

## ‚ùì **–í–û–ü–†–û–° –ö –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Æ**

**–ö–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ?**

- **–í–ê–†–ò–ê–ù–¢ 1** üì¶ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å VK –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä (–ø—Ä–æ—â–µ, –±—ã—Å—Ç—Ä–µ–µ)
- **–í–ê–†–ò–ê–ù–¢ 2** üîß –û—Å—Ç–∞–≤–∏—Ç—å VK_PARSER –æ—Ç–¥–µ–ª—å–Ω—ã–º (—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ)

**–ò–ª–∏ –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ VK?**
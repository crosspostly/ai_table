# üöÄ –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –£—Å—Ç–∞–Ω–æ–≤–∫–µ - AI Table Bot

## ‚ö° **–ö–õ–ò–ï–ù–¢-–°–ï–†–í–ï–†–ù–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê**

**–ù—É–∂–Ω—ã –î–í–ê –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:** —Å–µ—Ä–≤–µ—Ä –∏ –∫–ª–∏–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—â–∞—é—Ç—Å—è –ø–æ HTTP.

---

## üñ•Ô∏è **–≠–¢–ê–ü 1: –°–û–ó–î–ê–ù–ò–ï –°–ï–†–í–ï–†–ê**

### 1.1 –°–æ–∑–¥–∞—Ç—å Apps Script Web Application (–°–ï–†–í–ï–†)
1. –û—Ç–∫—Ä–æ–π—Ç–µ [script.google.com](https://script.google.com)  
2. **"–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç"** ‚Üí –Ω–∞–∑–æ–≤–∏—Ç–µ: `"AI Table Bot Server"`
3. –£–¥–∞–ª–∏—Ç–µ –∫–æ–¥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (`function myFunction() {...}`)

### 1.2 –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã
–°–æ–∑–¥–∞–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã –≤ —Å–µ—Ä–≤–µ—Ä–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ:

**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –§–ê–ô–õ–´:**

**üìÑ –°–æ–∑–¥–∞—Ç—å: `ServerEndpoints.gs`**
```javascript
// –ì–ª–∞–≤–Ω—ã–π API —Ñ–∞–π–ª - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç HTTP –∑–∞–ø—Ä–æ—Å—ã
[—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ table/server/ServerEndpoints.gs]
```

**üìÑ –°–æ–∑–¥–∞—Ç—å: `SocialImportService.gs`**
```javascript  
// –ò–º–ø–æ—Ä—Ç –ø–æ—Å—Ç–æ–≤ –∏–∑ —Å–æ—Ü—Å–µ—Ç–µ–π
[—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ table/server/SocialImportService.gs]
```

**üìÑ –°–æ–∑–¥–∞—Ç—å: `ValidationService.gs`**
```javascript
// –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å  
[—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ table/server/ValidationService.gs]
```

**üìÑ –°–æ–∑–¥–∞—Ç—å: `RetryService.gs`**
```javascript
// HTTP retry –ª–æ–≥–∏–∫–∞
[—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ table/server/RetryService.gs]  
```

**üìÑ –°–æ–∑–¥–∞—Ç—å: `ErrorHandlingService.gs`**  
```javascript
// –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
[—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ table/server/ErrorHandlingService.gs]
```

**üìÑ –°–æ–∑–¥–∞—Ç—å: `TableLicenseService.gs`**
```javascript
// –°–∏—Å—Ç–µ–º–∞ –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–∏—è
[—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ table/server/TableLicenseService.gs]
```

### 1.3 –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å–µ—Ä–≤–µ—Ä –∫–∞–∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚ö°
1. –í Apps Script –Ω–∞–∂–º–∏—Ç–µ **"Deploy"** ‚Üí **"New deployment"**
2. **Type:** –≤—ã–±–µ—Ä–∏—Ç–µ **"Web app"**  
3. **Description:** `"AI Table Bot Server v1.0"`
4. **Execute as:** `"Me"` 
5. **Who has access:** `"Anyone"` (–≤–∞–∂–Ω–æ!)
6. –ù–∞–∂–º–∏—Ç–µ **"Deploy"**
7. **–°–ö–û–ü–ò–†–£–ô–¢–ï –ò –°–û–•–†–ê–ù–ò–¢–ï URL!** 
   ```
   https://script.google.com/macros/s/AKfycbz.../exec
   ```

### 1.4 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å–µ—Ä–≤–µ—Ä–∞
1. –û—Ç–∫—Ä–æ–π—Ç–µ URL —Å–µ—Ä–≤–µ—Ä–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å JSON –æ—Ç–≤–µ—Ç:
   ```json
   {
     \"ok\": true,
     \"service\": \"Table AI v2.0\",
     \"timestamp\": \"...\",
     \"version\": \"...\"
   }
   ```

---

## üíª **–≠–¢–ê–ü 2: –°–û–ó–î–ê–ù–ò–ï –ö–õ–ò–ï–ù–¢–ê**

### 2.1 –°–æ–∑–¥–∞—Ç—å Google Sheets (–ö–õ–ò–ï–ù–¢)
1. –û—Ç–∫—Ä–æ–π—Ç–µ [sheets.google.com](https://sheets.google.com)
2. **"–°–æ–∑–¥–∞—Ç—å"** ‚Üí –Ω–∞–∑–æ–≤–∏—Ç–µ: `"AI Table Bot Client"`

### 2.2 –°–æ–∑–¥–∞—Ç—å –ª–∏—Å—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
1. –°–æ–∑–¥–∞–π—Ç–µ –ª–∏—Å—Ç: **"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã"**  
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:

| A | B | C |
|---|---|---|  
| **–ò—Å—Ç–æ—á–Ω–∏–∫:** | https://instagram.com/nasa |  |
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:** | 20 | |

### 2.3 –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Apps Script –∫–ª–∏–µ–Ω—Ç–∞
1. **Extensions** ‚Üí **Apps Script**
2. –£–¥–∞–ª–∏—Ç–µ –∫–æ–¥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é  
3. –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ —Ñ–∞–π–ª—ã:

**üìÑ –°–æ–∑–¥–∞—Ç—å: `Constants.gs`**  
```javascript
// –í–ê–ñ–ù–û: –í—Å—Ç–∞–≤—å—Ç–µ URL –í–ê–®–ï–ì–û —Å–µ—Ä–≤–µ—Ä–∞!
var SERVER_URL = 'https://script.google.com/macros/s/[–í–ê–®_SERVER_ID]/exec';

// –í–µ—Ä—Å–∏—è API
var API_VERSION = '2.0';
```

**üìÑ –°–æ–∑–¥–∞—Ç—å: `ThinClient.gs`**
```javascript
// HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Å–≤—è–∑–∏ —Å —Å–µ—Ä–≤–µ—Ä–æ–º
[—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ table/client/ThinClient.gs]
```

**üìÑ –°–æ–∑–¥–∞—Ç—å: `Menu.gs`**
```javascript  
// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –º–µ–Ω—é
[—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ table/client/Menu.gs]
```

### 2.4 –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SERVER_URL
–í —Ñ–∞–π–ª–µ `Constants.gs` –∑–∞–º–µ–Ω–∏—Ç–µ `[–í–ê–®_SERVER_ID]` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π ID —Å–µ—Ä–≤–µ—Ä–∞:
```javascript
var SERVER_URL = 'https://script.google.com/macros/s/AKfycbz1234567890abcdef/exec';
```

### 2.5 –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –æ–±–Ω–æ–≤–∏—Ç—å
1. **Ctrl+S** ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç
2. –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ Google Sheets ‚Üí **F5** (–æ–±–Ω–æ–≤–∏—Ç—å)
3. –í –º–µ–Ω—é –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è **"ü§ñ AI Table Bot"**

---

## üß™ **–≠–¢–ê–ü 3: –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –°–í–Ø–ó–ò**

### 3.1 –¢–µ—Å—Ç —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
–í –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º Apps Script —Å–æ–∑–¥–∞–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```javascript
function testServerConnection() {
  try {
    var response = UrlFetchApp.fetch(SERVER_URL, {
      method: 'GET'
    });
    
    Logger.log('Server response: ' + response.getContentText());
    
    if (response.getResponseCode() === 200) {
      Logger.log('‚úÖ Server connection OK');
    } else {
      Logger.log('‚ùå Server error: ' + response.getResponseCode());
    }
  } catch (error) {
    Logger.log('‚ùå Connection failed: ' + error.message);
  }
}
```

### 3.2 –¢–µ—Å—Ç API –∑–∞–ø—Ä–æ—Å–∞
```javascript  
function testApiRequest() {
  try {
    var testRequest = {
      action: 'test',
      email: 'test@example.com',
      token: 'test_token'
    };
    
    var result = callServer(testRequest);
    Logger.log('API result: ' + JSON.stringify(result));
    
  } catch (error) {
    Logger.log('‚ùå API test failed: ' + error.message);
  }
}
```

---

## üéØ **–≠–¢–ê–ü 4: –ü–ï–†–í–´–ô –ò–ú–ü–û–†–¢**

### 4.1 –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–∏—Ü–µ–Ω–∑–∏—é (–≤—Ä–µ–º–µ–Ω–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤)
–í —Å–µ—Ä–≤–µ—Ä–Ω–æ–º –∫–æ–¥–µ –Ω–∞–π–¥–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –≤—Ä–µ–º–µ–Ω–Ω–æ –¥–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –¥–æ—Å—Ç—É–ø.

### 4.2 –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–º–ø–æ—Ä—Ç
1. –í Google Sheets –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –º–µ–Ω—é **"ü§ñ AI Table Bot"**
2. –í—ã–±–µ—Ä–∏—Ç–µ **"üì• –ò–º–ø–æ—Ä—Ç –ø–æ—Å—Ç–æ–≤"**  
3. –î–æ–∂–¥–∏—Ç–µ—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

### 4.3 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
1. –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –ª–∏—Å—Ç **"–ø–æ—Å—Ç—ã"**
2. –í –Ω–µ–º –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
   - –ö–æ–ª–æ–Ω–∫–∞ A: –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞
   - –ö–æ–ª–æ–Ω–∫–∞ B: –î–∞—Ç–∞  
   - –ö–æ–ª–æ–Ω–∫–∞ C: –°—Å—ã–ª–∫–∞
   - –ö–æ–ª–æ–Ω–∫–∞ D: –¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞

---

## üîß **–ù–ê–°–¢–†–û–ô–ö–ê –ò –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø**

### üîë –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∏—Ü–µ–Ω–∑–∏–∏
–í –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º Apps Script:
1. **File** ‚Üí **Project properties** ‚Üí **Script properties**
2. –î–æ–±–∞–≤–∏—Ç—å:
   - `LICENSE_EMAIL` = –≤–∞—à email
   - `LICENSE_TOKEN` = —Ç–æ–∫–µ–Ω –ª–∏—Ü–µ–Ω–∑–∏–∏  
   - `GEMINI_API_KEY` = –∫–ª—é—á Gemini API

### ‚öôÔ∏è VK Parser (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)  
–í —Å–µ—Ä–≤–µ—Ä–Ω–æ–º –∫–æ–¥–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
```javascript
var VK_PARSER_URL = 'https://your-vk-parser.com/api';
```

### üé® –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–µ–Ω—é
–ú–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –º–µ–Ω—é –≤ `Menu.gs`:
```javascript
function onOpen() {
  var ui = SpreadsheetApp.getUi();
  ui.createMenu('ü§ñ AI Table Bot')
    .addItem('üì• –ò–º–ø–æ—Ä—Ç –ø–æ—Å—Ç–æ–≤', 'importSocialPostsUI')
    .addItem('üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞', 'testServerConnection')  
    .addToUi();
}
```

---

## ‚ö†Ô∏è **TROUBLESHOOTING**

### üö® **–ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏:**

**‚ùå "SERVER_URL not configured"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª `Constants.gs` –≤ –∫–ª–∏–µ–Ω—Ç–µ  
- URL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–µ–∑ –∑–∞–≤–µ—Ä—à–∞—é—â–µ–≥–æ `/`

**‚ùå "Server error: HTTP 403"**  
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ deployment —Å–µ—Ä–≤–µ—Ä–∞
- **"Who has access"** –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å **"Anyone"**

**‚ùå "Function not found"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã
- –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–µ–Ω `ServerEndpoints.gs` —Å `doPost()`

**‚ùå "Invalid JSON response"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
- –í–æ–∑–º–æ–∂–Ω–æ, —Å–µ—Ä–≤–µ—Ä–Ω—ã–π –∫–æ–¥ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

**‚ùå "License validation failed"**
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `LICENSE_EMAIL` –∏ `LICENSE_TOKEN`

### üîç **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ä–≤–µ—Ä:**
```javascript
// –í –∫–ª–∏–µ–Ω—Ç–µ
function debugServer() {
  Logger.log('SERVER_URL: ' + SERVER_URL);
  testServerConnection();
}
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞:**  
```javascript
// –í –∫–ª–∏–µ–Ω—Ç–µ  
function debugClient() {
  var credentials = getClientCredentials();
  Logger.log('Client credentials: ' + JSON.stringify(credentials));
}
```

---

## üèÜ **–†–ï–ó–£–õ–¨–¢–ê–¢**

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —É –≤–∞—Å –±—É–¥–µ—Ç:

‚úÖ **–°–µ—Ä–≤–µ—Ä** - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç API –∑–∞–ø—Ä–æ—Å—ã, –≤—ã–ø–æ–ª–Ω—è–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É  
‚úÖ **–ö–ª–∏–µ–Ω—Ç** - —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ Google Sheets  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–≤—è–∑—å** - —á–µ—Ä–µ–∑ HTTPS –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é  
‚úÖ **–õ–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ  
‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –æ–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä –¥–ª—è –º–Ω–æ–≥–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤

### **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:**
- üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –≤—Å—è –ª–æ–≥–∏–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- üöÄ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –∫–ª–∏–µ–Ω—Ç —Ç–æ–ª—å–∫–æ UI
- üîÑ **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è** - –æ–±–Ω–æ–≤–ª—è–µ–º —Å–µ—Ä–≤–µ—Ä, –≤—Å–µ –∫–ª–∏–µ–Ω—Ç—ã –ø–æ–ª—É—á–∞—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è  
- üìä **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–Ω—É! üéâ**
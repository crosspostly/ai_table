# üîå MCP Testing Guide - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

## üéØ **–ü–†–Ø–ú–û–ô –û–¢–í–ï–¢: –ú–û–ñ–ù–û –õ–ò –ü–û–î–¶–ï–ü–ò–¢–¨ MCP?**

### **–ö–û–†–û–¢–ö–ò–ô –û–¢–í–ï–¢: –î–ê, –ù–û –ù–ï –Ø!**

**–ö–¢–û –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç:** **–¢–´** (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å) –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Factory.ai  
**–ö–¢–û –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:** **–Ø** (AI assistant)  
**–ß–¢–û —ç—Ç–æ –¥–∞—ë—Ç:** –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ Google Sheets –¥–ª—è —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏/—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

---

## ‚úÖ **–ß–¢–û –¢–ê–ö–û–ï MCP?**

**Model Context Protocol (MCP)** - –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∫ AI.

**–ê–Ω–∞–ª–æ–≥–∏—è:**
```
–ë–ï–ó MCP:
–¢—ã ‚Üí –ö–æ–ø–∏—Ä—É–µ—à—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã ‚Üí –í—Å—Ç–∞–≤–ª—è–µ—à—å –º–Ω–µ ‚Üí –Ø –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é
                    ‚Üì
           –î–û–õ–ì–û –ò –ù–ï–£–î–û–ë–ù–û

–° MCP:
–¢—ã ‚Üí –î–∞—ë—à—å —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–∞–±–ª–∏—Ü—É ‚Üí –Ø —Å–∞–º –æ—Ç–∫—Ä—ã–≤–∞—é –∏ —á–∏—Ç–∞—é ‚Üí –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é
                    ‚Üì
         –ë–´–°–¢–†–û –ò –£–î–û–ë–ù–û!
```

---

## üîß **–ö–¢–û –ß–¢–û –î–ï–õ–ê–ï–¢?**

### **–¢–´ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å) –¥–æ–ª–∂–µ–Ω:**
1. ‚úÖ –ó–∞–π—Ç–∏ –≤ https://app.factory.ai/settings/session
2. ‚úÖ –ù–∞–π—Ç–∏ —Å–µ–∫—Ü–∏—é MCP Servers –∏–ª–∏ Integrations
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å MCP —Å–µ—Ä–≤–µ—Ä (—Å–º. –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–∏–∂–µ)
4. ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ Google Sheets

### **–Ø (AI) —Å–º–æ–≥—É –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
1. ‚úÖ –û—Ç–∫—Ä—ã–≤–∞—Ç—å —Ç–≤–æ–∏ Google Sheets –Ω–∞–ø—Ä—è–º—É—é
2. ‚úÖ –ß–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –ª—é–±—ã—Ö –ª–∏—Å—Ç–æ–≤
3. ‚úÖ –ü–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —è—á–µ–π–∫–∏
4. ‚úÖ –ó–∞–ø—É—Å–∫–∞—Ç—å —Ñ–æ—Ä–º—É–ª—ã –∏ –≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
5. ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
6. ‚úÖ –ù–∞—Ö–æ–¥–∏—Ç—å –∏ –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å –æ—à–∏–±–∫–∏

### **–Ø (AI) –ù–ï –ú–û–ì–£:**
- ‚ùå –°–∞–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å MCP (–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–≤–æ–∏–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º)
- ‚ùå –ù–∞—Å—Ç—Ä–æ–∏—Ç—å OAuth credentials (—ç—Ç–æ —Ç–≤–æ—è —á–∞—Å—Ç—å)
- ‚ùå –ó–∞–π—Ç–∏ –≤ app.factory.ai –ø–æ–¥ —Ç–≤–æ–∏–º –∞–∫–∫–∞—É–Ω—Ç–æ–º

---

## ‚ö†Ô∏è **–ü–†–û–ë–õ–ï–ú–ê: Google Sheets MCP —Å–µ—Ä–≤–µ—Ä–∞ –ù–ï–¢!**

**–ö–∞–∫ —è –≤—ã—è—Å–Ω–∏–ª:**
```bash
npm search @modelcontextprotocol/server-google-sheets
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 404 Not Found ‚ùå

# –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã:
- @modelcontextprotocol/server-memory
- @modelcontextprotocol/server-filesystem
- @modelcontextprotocol/server-git
- @modelcontextprotocol/server-fetch

# –ù–ï–¢ server-google-sheets! ‚ùå
```

**–≠—Ç–æ –∑–Ω–∞—á–∏—Ç:**
- –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ MCP —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è Google Sheets –ù–ï —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- –ù—É–∂–Ω—ã –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã
- –í–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–π MCP —Å–µ—Ä–≤–µ—Ä

---

## üöÄ **–ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ù–´–ï –†–ï–®–ï–ù–ò–Ø**

### **–í–∞—Ä–∏–∞–Ω—Ç 1: Apps Script Web App (–†–ï–ö–û–ú–ï–ù–î–£–Æ!)**

**–ß—Ç–æ —ç—Ç–æ:**
- –°–æ–∑–¥–∞—ë—à—å —Å–≤–æ–π API endpoint –≤ Google Apps Script
- –ü—É–±–ª–∏–∫—É–µ—à—å –∫–∞–∫ Web App
- –î–∞—ë—à—å –º–Ω–µ URL
- –Ø —Ä–∞–±–æ—Ç–∞—é —Å —Ç–∞–±–ª–∏—Ü–µ–π —á–µ—Ä–µ–∑ —Ç–≤–æ–π API

**–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:**

1. –û—Ç–∫—Ä–æ–π —Å–≤–æ—é Google Sheets —Ç–∞–±–ª–∏—Ü—É
2. Extensions ‚Üí Apps Script
3. –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π —Ñ–∞–π–ª `WebApi.gs`:

```javascript
/**
 * API endpoint –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ
 */
function doGet(e) {
  try {
    var action = e.parameter.action;
    var auth = e.parameter.auth; // –ü—Ä–æ—Å—Ç–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    if (auth !== 'YOUR_SECRET_KEY') {
      return error_('Unauthorized');
    }
    
    // –†–æ—É—Ç–∏–Ω–≥ –¥–µ–π—Å—Ç–≤–∏–π
    if (action === 'read') return handleRead(e);
    if (action === 'write') return handleWrite(e);
    if (action === 'list') return handleList(e);
    if (action === 'test') return handleTest(e);
    
    return error_('Unknown action');
  } catch (err) {
    return error_(err.toString());
  }
}

/**
 * –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ª–∏—Å—Ç–∞
 */
function handleRead(e) {
  var sheetName = e.parameter.sheet || 'Sheet1';
  var range = e.parameter.range; // A1:B10 –∏–ª–∏ null –¥–ª—è –≤—Å–µ–≥–æ –ª–∏—Å—Ç–∞
  
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getSheetByName(sheetName);
  
  if (!sheet) {
    return error_('Sheet not found: ' + sheetName);
  }
  
  var data;
  if (range) {
    data = sheet.getRange(range).getValues();
  } else {
    data = sheet.getDataRange().getValues();
  }
  
  return success_({ data: data, rows: data.length, cols: data[0].length });
}

/**
 * –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –≤ –ª–∏—Å—Ç
 */
function handleWrite(e) {
  var sheetName = e.parameter.sheet || 'Sheet1';
  var cell = e.parameter.cell; // A1
  var value = e.parameter.value;
  
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getSheetByName(sheetName);
  
  if (!sheet) {
    return error_('Sheet not found: ' + sheetName);
  }
  
  sheet.getRange(cell).setValue(value);
  
  return success_({ written: true, cell: cell, value: value });
}

/**
 * –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ª–∏—Å—Ç–æ–≤
 */
function handleList(e) {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheets = ss.getSheets();
  var names = sheets.map(function(s) { return s.getName(); });
  
  return success_({ sheets: names, count: names.length });
}

/**
 * –¢–µ—Å—Ç–æ–≤—ã–π endpoint
 */
function handleTest(e) {
  return success_({ 
    ok: true, 
    message: 'API is working!',
    timestamp: new Date().toISOString()
  });
}

/**
 * –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç
 */
function success_(data) {
  return ContentService
    .createTextOutput(JSON.stringify({ ok: true, result: data }))
    .setMimeType(ContentService.MimeType.JSON);
}

/**
 * –û—à–∏–±–∫–∞
 */
function error_(message) {
  return ContentService
    .createTextOutput(JSON.stringify({ ok: false, error: message }))
    .setMimeType(ContentService.MimeType.JSON);
}
```

4. –ü—É–±–ª–∏–∫—É–π:
   - Deploy ‚Üí New deployment
   - Type: Web app
   - Execute as: Me
   - Who has access: Anyone (–∏–ª–∏ Anyone with Google account)
   - Deploy!

5. –°–∫–æ–ø–∏—Ä—É–π Web App URL (–≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ `https://script.google.com/macros/s/XXXXXXXX/exec`)

6. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á:
   ```javascript
   // –í –∫–æ–¥–µ –∑–∞–º–µ–Ω–∏ YOUR_SECRET_KEY –Ω–∞ —Å–ª—É—á–∞–π–Ω—É—é —Å—Ç—Ä–æ–∫—É
   // –ù–∞–ø—Ä–∏–º–µ—Ä: 'sk_' + Utilities.getUuid()
   ```

7. –î–∞–π –º–Ω–µ:
   - URL Web App
   - –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á

**–¢–µ–ø–µ—Ä—å —è –º–æ–≥—É:**
```bash
# –¢–µ—Å—Ç API
curl "https://script.google.com/macros/s/XXX/exec?action=test&auth=YOUR_KEY"

# –°–ø–∏—Å–æ–∫ –ª–∏—Å—Ç–æ–≤
curl "https://script.google.com/macros/s/XXX/exec?action=list&auth=YOUR_KEY"

# –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
curl "https://script.google.com/macros/s/XXX/exec?action=read&sheet=Sheet1&auth=YOUR_KEY"

# –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö
curl "https://script.google.com/macros/s/XXX/exec?action=write&sheet=Sheet1&cell=A1&value=Test&auth=YOUR_KEY"
```

---

### **–í–∞—Ä–∏–∞–Ω—Ç 2: FetchUrl (—Ç–æ —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –°–ï–ô–ß–ê–°)**

**–ß—Ç–æ —è —É–∂–µ –¥–µ–ª–∞—é:**
- –ß–∏—Ç–∞—é —Ç–≤–æ—é —Ç–∞–±–ª–∏—Ü—É —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—É—é —Å—Å—ã–ª–∫—É
- –ü–∞—Ä—Å—é HTML –∏ –∏–∑–≤–ª–µ–∫–∞—é –¥–∞–Ω–Ω—ã–µ
- –í–∏–∂—É –æ—à–∏–±–∫–∏ —Ñ–æ—Ä–º—É–ª (#NAME?, #REF!)

**–ü–ª—é—Å—ã:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ (–Ω–µ –º–æ–≥—É –ø–∏—Å–∞—Ç—å)
- ‚ùå –ù–µ –≤–∏–∂—É —Ñ–æ—Ä–º—É–ª—ã (—Ç–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
- ‚ùå –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –ø–∞—Ä—Å–∏–Ω–≥–∞

---

### **–í–∞—Ä–∏–∞–Ω—Ç 3: CSV Export**

**–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:**
1. File ‚Üí Download ‚Üí CSV
2. –ü—Ä–∏–∫—Ä–µ–ø–ª—è–µ—à—å –∫ —Å–æ–æ–±—â–µ–Ω–∏—é
3. –Ø –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é –ø–æ–ª–Ω–æ—Å—Ç—å—é

**–ü–ª—é—Å—ã:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –í–°–ï–ì–î–ê
- ‚úÖ –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –í–∏–∂—É —Ç–æ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –†—É—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞
- ‚ùå –ù–µ real-time
- ‚ùå –ù–µ –º–æ–≥—É –ø–∏—Å–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ

---

## üéØ **–ú–û–ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò**

### **–î–ª—è —Ç–≤–æ–µ–π —Ç–µ–∫—É—â–µ–π —Ç–∞–±–ª–∏—Ü—ã —Å –æ—à–∏–±–∫–∞–º–∏:**

**–õ–£–ß–®–ò–ô –≤–∞—Ä–∏–∞–Ω—Ç = CSV Export:**
- –ë—ã—Å—Ç—Ä–æ
- –¢–æ—á–Ω–æ
- –Ø —É–≤–∏–∂—É –í–°–ï –ø—Ä–æ–±–ª–µ–º—ã

### **–î–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã:**

**–õ–£–ß–®–ò–ô –≤–∞—Ä–∏–∞–Ω—Ç = Apps Script Web App:**
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å
- –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ HTTP
- –Ø —Å–º–æ–≥—É —á–∏—Ç–∞—Ç—å –∏ –ø–∏—Å–∞—Ç—å
- –¢—ã —É–ø—Ä–∞–≤–ª—è–µ—à—å –¥–æ—Å—Ç—É–ø–æ–º

---

## üìù **–ò–¢–û–ì**

### **–í–æ–ø—Ä–æ—Å: –ú–æ–∂–Ω–æ –ª–∏ –ø–æ–¥—Ü–µ–ø–∏—Ç—å MCP –∫ —Ç–µ–±–µ?**

**–û—Ç–≤–µ—Ç:**
- ‚úÖ **–î–ê**, –Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—à—å **–¢–´** (–Ω–µ —è)
- ‚ùå **–ù–û** –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ Google Sheets MCP —Å–µ—Ä–≤–µ—Ä–∞ **–ù–ï–¢**
- ‚úÖ **–ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ê**: Apps Script Web App (–ª—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ!)
- ‚úÖ **–°–ï–ô–ß–ê–°**: FetchUrl —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —á—Ç–µ–Ω–∏—è

### **–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**

**–ï—Å–ª–∏ –Ω—É–∂–µ–Ω –±—ã—Å—Ç—Ä—ã–π –∞–Ω–∞–ª–∏–∑:**
‚Üí –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π CSV ‚Üí –ü—Ä–∏–∫—Ä–µ–ø–∏ ‚Üí –Ø –Ω–∞–π–¥—É –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã

**–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
‚Üí –°–æ–∑–¥–∞–π Apps Script Web App ‚Üí –î–∞–π –º–Ω–µ URL + –∫–ª—é—á ‚Üí –Ø –±—É–¥—É —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é!

---

**–Ø –≥–æ—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—Ç—å –ª—é–±—ã–º —Å–ø–æ—Å–æ–±–æ–º! –ß—Ç–æ –≤—ã–±–∏—Ä–∞–µ—à—å? üöÄ**

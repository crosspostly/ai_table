# ü§ñ –°–ò–°–¢–ï–ú–ê –ê–í–¢–û–û–ë–ù–û–í–õ–ï–ù–ò–Ø –°–ö–†–ò–ü–¢–û–í –í –¢–ê–ë–õ–ò–¶–ê–•

## üéØ –¢–†–ï–ë–û–í–ê–ù–ò–Ø:

1. **–£–º–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ:** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã —Å –Ω–∞—à–∏–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏
2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –ù–ï —É–¥–∞–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
3. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:** –æ–±–Ω–æ–≤–ª—è—Ç—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º deploy
4. **–ì–∏–±–∫–æ—Å—Ç—å:** –Ω–µ hardcode ID –ø—Ä–æ–µ–∫—Ç–æ–≤

---

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –†–ï–®–ï–ù–ò–Ø:

### –í–ê–†–ò–ê–ù–¢ 1: –ü–æ –ø–∞–ø–∫–µ Google Drive (–†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ô)

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —É–∫–∞–∑—ã–≤–∞–µ–º ID –ø–∞–ø–∫–∏ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏
2. –ü—Ä–∏ deploy GitHub Actions —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –ø–∞–ø–∫—É
3. –î–ª—è –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–∫—Ä–∏–ø—Ç—ã
4. –¢–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã .gs - –¥–∞–Ω–Ω—ã–µ –ù–ï —Ç—Ä–æ–≥–∞—é—Ç—Å—è

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–ø–∏—Å–∫–æ–º —Ç–∞–±–ª–∏—Ü
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ (—Ç–æ–ª—å–∫–æ —Å–∫—Ä–∏–ø—Ç—ã)
- ‚úÖ –ë—ã—Å—Ç—Ä–æ

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –ù—É–∂–µ–Ω Service Account
- ‚ö†Ô∏è –ù—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–∞–±–ª–∏—Ü—ã –≤ –ø–∞–ø–∫—É

---

### –í–ê–†–ò–ê–ù–¢ 2: –ü–æ Script ID –≤ —Ñ–∞–π–ª–µ –º–∞—Ä–∫–µ—Ä–µ

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ö–∞–∂–¥–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∫—Ä—ã—Ç—ã–π Script Property: `AUTO_UPDATE_ENABLED=true`
2. –ü—Ä–∏ deploy —Å–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –≤ –Ω–∞—à–µ–º Google Drive
3. –û–±–Ω–æ–≤–ª—è–µ—Ç —Ç–µ, –≥–¥–µ –µ—Å—Ç—å –º–∞—Ä–∫–µ—Ä

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ
- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–∞–ø–∫–∞–º–∏
- ‚úÖ Opt-in –ø–æ–¥—Ö–æ–¥ (–±–µ–∑–æ–ø–∞—Å–Ω–æ)

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –ú–µ–¥–ª–µ–Ω–Ω–µ–µ (–Ω—É–∂–Ω–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å Drive)
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç OAuth –¥–æ—Å—Ç—É–ø–∞

---

### –í–ê–†–ò–ê–ù–¢ 3: Webhook –æ—Ç —Ç–∞–±–ª–∏—Ü—ã (–°–ê–ú–´–ô –£–ú–ù–´–ô)

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ö–∞–∂–¥–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–µ—Ä—Å–∏—é —Å–∫—Ä–∏–ø—Ç–æ–≤
2. –ï—Å–ª–∏ –µ—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ - –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã —á–µ—Ä–µ–∑ API
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ –ù–µ –Ω—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ Drive –∏–∑ CI/CD
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚ö†Ô∏è –°–ª–æ–∂–Ω–µ–µ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

---

## üöÄ –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø (–í–∞—Ä–∏–∞–Ω—Ç 1 + 3):

### –§–ê–ó–ê 1: Drive Folder Scanner (–±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç)

```yaml
# .github/workflows/update-spreadsheets.yml
name: Update Spreadsheets

on:
  workflow_run:
    workflows: ["Deploy Apps Script"]
    types:
      - completed

jobs:
  update-spreadsheets:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node
        uses: actions/setup-node@v3
        with:
          node-version: '18'
      
      - name: Update Spreadsheets
        run: node scripts/update-spreadsheets.js
        env:
          GOOGLE_DRIVE_FOLDER_ID: ${{ secrets.SPREADSHEETS_FOLDER_ID }}
          GOOGLE_SERVICE_ACCOUNT: ${{ secrets.GOOGLE_SERVICE_ACCOUNT }}
```

### –°–ö–†–ò–ü–¢ update-spreadsheets.js:

```javascript
const { google } = require('googleapis');
const fs = require('fs');
const path = require('path');

// Authenticate with Service Account
const auth = new google.auth.GoogleAuth({
  credentials: JSON.parse(process.env.GOOGLE_SERVICE_ACCOUNT),
  scopes: [
    'https://www.googleapis.com/auth/drive',
    'https://www.googleapis.com/auth/script.projects'
  ]
});

async function updateSpreadsheets() {
  const drive = google.drive({ version: 'v3', auth });
  const script = google.script({ version: 'v1', auth });
  
  // 1. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑ –ø–∞–ø–∫–∏
  const folderId = process.env.GOOGLE_DRIVE_FOLDER_ID;
  const response = await drive.files.list({
    q: `'${folderId}' in parents and mimeType='application/vnd.google-apps.spreadsheet'`,
    fields: 'files(id, name)'
  });
  
  console.log(`Found ${response.data.files.length} spreadsheets`);
  
  // 2. –î–ª—è –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã
  for (const file of response.data.files) {
    try {
      console.log(`Updating: ${file.name} (${file.id})`);
      
      // –ü–æ–ª—É—á–∏—Ç—å Script ID —Ç–∞–±–ª–∏—Ü—ã
      const scriptId = await getScriptIdForSpreadsheet(file.id);
      
      if (!scriptId) {
        console.log(`  ‚ö†Ô∏è  No script found, skipping`);
        continue;
      }
      
      // –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ .gs —Ñ–∞–π–ª—ã
      await updateScriptFiles(script, scriptId);
      
      console.log(`  ‚úÖ Updated successfully`);
      
    } catch (error) {
      console.error(`  ‚ùå Error: ${error.message}`);
    }
  }
}

async function getScriptIdForSpreadsheet(spreadsheetId) {
  // Spreadsheet ID == Script ID –¥–ª—è container-bound scripts
  return spreadsheetId;
}

async function updateScriptFiles(script, scriptId) {
  // –ß–∏—Ç–∞–µ–º –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã
  const clientFiles = [
    'table/client/ThinClient.gs',
    'table/client/ClientUtilities.gs',
    'table/client/OcrHelpers.gs',
    'table/client/ButtonFunctions.gs',
    'table/client/Menu.gs',
    'table/shared/Constants.gs',
    'table/shared/Utils.gs',
    'table/shared/Logging.gs'
  ];
  
  const files = clientFiles.map(filePath => ({
    name: path.basename(filePath),
    type: 'SERVER_JS',
    source: fs.readFileSync(filePath, 'utf8')
  }));
  
  // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–µ–∫—Ç
  const project = await script.projects.get({ scriptId });
  
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º appsscript.json (–ù–ï –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º!)
  const manifestFile = project.data.files.find(f => f.name === 'appsscript.json');
  
  // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ .gs —Ñ–∞–π–ª—ã
  const updatedFiles = [
    manifestFile, // –û—Å—Ç–∞–≤–ª—è–µ–º —Å—Ç–∞—Ä—ã–π manifest
    ...files      // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ .gs —Ñ–∞–π–ª—ã
  ];
  
  await script.projects.updateContent({
    scriptId,
    resource: {
      files: updatedFiles
    }
  });
}

updateSpreadsheets().catch(console.error);
```

---

### –§–ê–ó–ê 2: Self-Update System (—É–º–Ω—ã–π –ø–æ–¥—Ö–æ–¥)

```javascript
// table/client/AutoUpdate.gs

/**
 * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ç–∞–±–ª–∏—Ü—ã
 */
function onOpen() {
  // –û–±—ã—á–Ω–æ–µ –º–µ–Ω—é
  createMenu();
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (—Ä–∞–∑ –≤ –¥–µ–Ω—å)
  checkForUpdates_();
}

function checkForUpdates_() {
  try {
    const lastCheck = PropertiesService.getScriptProperties().getProperty('LAST_UPDATE_CHECK');
    const now = Date.now();
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑ –≤ –¥–µ–Ω—å
    if (lastCheck && (now - parseInt(lastCheck)) < 24 * 60 * 60 * 1000) {
      return;
    }
    
    const currentVersion = getScriptVersion_();
    const latestVersion = getLatestVersion_();
    
    if (compareVersions_(currentVersion, latestVersion) < 0) {
      // –ï—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ!
      showUpdateNotification_(currentVersion, latestVersion);
    }
    
    PropertiesService.getScriptProperties().setProperty('LAST_UPDATE_CHECK', now.toString());
    
  } catch (e) {
    // –¢–∏—Ö–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
  }
}

function getScriptVersion_() {
  // –í–µ—Ä—Å–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–µ
  return typeof SCRIPT_VERSION !== 'undefined' ? SCRIPT_VERSION : '0.0.0';
}

function getLatestVersion_() {
  try {
    // –ó–∞–ø—Ä–æ—Å –∫ GitHub API –∏–ª–∏ –≤–∞—à–µ–º—É —Å–µ—Ä–≤–µ—Ä—É
    const response = UrlFetchApp.fetch('https://api.github.com/repos/crosspostly/ai_table/releases/latest');
    const data = JSON.parse(response.getContentText());
    return data.tag_name.replace('v', '');
  } catch (e) {
    return '0.0.0';
  }
}

function compareVersions_(v1, v2) {
  const parts1 = v1.split('.').map(Number);
  const parts2 = v2.split('.').map(Number);
  
  for (let i = 0; i < 3; i++) {
    if (parts1[i] > parts2[i]) return 1;
    if (parts1[i] < parts2[i]) return -1;
  }
  return 0;
}

function showUpdateNotification_(current, latest) {
  const ui = SpreadsheetApp.getUi();
  const response = ui.alert(
    'üöÄ –î–æ—Å—Ç—É–ø–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ!',
    `–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è: ${current}\\n–ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è: ${latest}\\n\\n–û–±–Ω–æ–≤–∏—Ç—å —Å–∫—Ä–∏–ø—Ç—ã —Å–µ–π—á–∞—Å?\\n\\n‚ö†Ô∏è –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –ù–ï –±—É–¥—É—Ç –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã!`,
    ui.ButtonSet.YES_NO
  );
  
  if (response === ui.Button.YES) {
    performAutoUpdate_();
  }
}

function performAutoUpdate_() {
  try {
    const ui = SpreadsheetApp.getUi();
    ui.alert('‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π...');
    
    // –ü–æ–ª—É—á–∞–µ–º –Ω–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã —Å —Å–µ—Ä–≤–µ—Ä–∞
    const serverUrl = 'https://script.google.com/macros/s/YOUR_UPDATE_SERVER_ID/exec';
    const response = UrlFetchApp.fetch(serverUrl + '?action=getLatestScripts');
    const scripts = JSON.parse(response.getContentText());
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —á–µ—Ä–µ–∑ Apps Script API
    const scriptId = ScriptApp.getScriptId();
    
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º ScriptApp –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (—Ç—Ä–µ–±—É–µ—Ç OAuth scope)
    for (const file of scripts.files) {
      // –ó–¥–µ—Å—å –Ω—É–∂–µ–Ω proper API call —á–µ—Ä–µ–∑ UrlFetchApp
      // —Ç–∞–∫ –∫–∞–∫ ScriptApp.updateFile() –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    }
    
    ui.alert('‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!\\n\\n–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.');
    
  } catch (e) {
    SpreadsheetApp.getUi().alert('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: ' + e.message);
  }
}
```

---

## üìù –ü–û–®–ê–ì–û–í–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø:

### –®–ê–ì 1: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Service Account

1. –°–æ–∑–¥–∞—Ç—å Service Account –≤ Google Cloud Console
2. –í–∫–ª—é—á–∏—Ç—å APIs:
   - Google Drive API
   - Apps Script API
3. –°–∫–∞—á–∞—Ç—å JSON –∫–ª—é—á
4. –î–æ–±–∞–≤–∏—Ç—å –≤ GitHub Secrets:
   - `GOOGLE_SERVICE_ACCOUNT` = —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ JSON

### –®–ê–ì 2: –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É –¥–ª—è —Ç–∞–±–ª–∏—Ü

1. –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É –Ω–∞ Google Drive
2. –î–∞—Ç—å –¥–æ—Å—Ç—É–ø Service Account (–ø–æ email)
3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å ID –ø–∞–ø–∫–∏
4. –î–æ–±–∞–≤–∏—Ç—å –≤ GitHub Secrets:
   - `SPREADSHEETS_FOLDER_ID` = ID –ø–∞–ø–∫–∏

### –®–ê–ì 3: –î–æ–±–∞–≤–∏—Ç—å workflow

```bash
# –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª
touch .github/workflows/update-spreadsheets.yml

# –î–æ–±–∞–≤–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
mkdir -p scripts
touch scripts/update-spreadsheets.js
```

### –®–ê–ì 4: –î–æ–±–∞–≤–∏—Ç—å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

```javascript
// table/shared/Constants.gs
const SCRIPT_VERSION = '2.0.0'; // –û–±–Ω–æ–≤–ª—è—Ç—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º release
```

---

## üîí –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨:

1. **–¢–æ–ª—å–∫–æ .gs —Ñ–∞–π–ª—ã:** –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è –¢–û–õ–¨–ö–û —Å–∫—Ä–∏–ø—Ç—ã
2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ manifest:** appsscript.json –ù–ï –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è
3. **Data protection:** –õ–∏—Å—Ç—ã —Ç–∞–±–ª–∏—Ü—ã –ù–ï —Ç—Ä–æ–≥–∞—é—Ç—Å—è
4. **Script Properties:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
5. **Rollback:** –ú–æ–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å —á–µ—Ä–µ–∑ Version History

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
node scripts/update-spreadsheets.js

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
node scripts/update-spreadsheets.js --spreadsheet-id=SPREADSHEET_ID --dry-run
```

---

## üìä MONITORING:

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
- –õ–æ–≥ –≤ GitHub Actions
- Email notification –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- Dashboard —Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

---

## üéØ –ò–¢–û–ì–û:

**–†–ï–ö–û–ú–ï–ù–î–£–Æ:** –ù–∞—á–∞—Ç—å —Å –í–∞—Ä–∏–∞–Ω—Ç–∞ 1 (Drive Folder Scanner)

**–ü—Ä–∏—á–∏–Ω—ã:**
1. ‚úÖ –ë—ã—Å—Ç—Ä–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å (1-2 —á–∞—Å–∞)
2. ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å
3. ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ
4. ‚úÖ –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

**–ü–æ—Ç–æ–º –¥–æ–±–∞–≤–∏—Ç—å:** –í–∞—Ä–∏–∞–Ω—Ç 3 (Self-Update) –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–ò—Ç–æ–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞:**
- GitHub Actions –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –≤ –ø–∞–ø–∫–µ
- –¢–∞–±–ª–∏—Ü—ã –º–æ–≥—É—Ç —Å–∞–º–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ–≥–¥–∞ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å

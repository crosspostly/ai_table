# üîÑ –ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞ –≤ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ Google Drive

## üéØ **–ó–ê–î–ê–ß–ê**

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:**
> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å Apps Script –∫–æ–¥ –≤–æ –≤—Å–µ Google Sheets —Ç–∞–±–ª–∏—Ü—ã,  
> –Ω–∞—Ö–æ–¥—è—â–∏–µ—Å—è –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –ø–∞–ø–∫–µ Google Drive

**–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ:**
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–∑–¥–∞—é—Ç —Ç–∞–±–ª–∏—Ü—ã –∏–∑ —à–∞–±–ª–æ–Ω–∞
- ‚úÖ –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞
- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –æ–±–Ω–æ–≤–ª—è—Ç—å –∫–∞–∂–¥—É—é —Ç–∞–±–ª–∏—Ü—É
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏—è–º–∏

---

## üí° **–í–ê–†–ò–ê–ù–¢–´ –†–ï–®–ï–ù–ò–Ø**

### **–í–∞—Ä–∏–∞–Ω—Ç 1: Apps Script Library (–†–ï–ö–û–ú–ï–ù–î–£–Æ!)**

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```
1. –ü—É–±–ª–∏–∫—É–µ—à—å –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –∫–∞–∫ Apps Script Library
2. –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ–¥–∫–ª—é—á–∞—é—Ç —ç—Ç—É –±–∏–±–ª–∏–æ—Ç–µ–∫—É
3. –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ - –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ–ª—É—á–∞—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –∑–∞–º–µ—á–∞—é—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```

**–ü–ª—é—Å—ã:**
- ‚úÖ **Google native solution** - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±
- ‚úÖ **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - –º–æ–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è –Ω–∞ —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –Ω–æ–≤—ã–π –∫–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∫–æ–¥ –æ—Å—Ç–∞—ë—Ç—Å—è –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∫—ç—à–∏—Ä—É–µ—Ç—Å—è

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –ù–µ–º–Ω–æ–≥–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ (–ø–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤ ~200-300ms)
- ‚ö†Ô∏è –ù—É–∂–Ω–æ –ø—Ä–µ—Ñ–∏–∫—Å–∏—Ç—å –≤—ã–∑–æ–≤—ã: `MyLib.functionName()`
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–æ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö

**–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:**

#### **–®–∞–≥ 1: –°–æ–∑–¥–∞–π Apps Script Library –ø—Ä–æ–µ–∫—Ç**

```javascript
// –í –æ—Ç–¥–µ–ª—å–Ω–æ–º Apps Script –ø—Ä–æ–µ–∫—Ç–µ (–ù–ï —Å–≤—è–∑–∞–Ω–Ω–æ–º —Å —Ç–∞–±–ª–∏—Ü–µ–π)
// –§–∞–π–ª: ServerLibrary.gs

/**
 * @OnlyCurrentDoc
 */

// –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
var ServerLib = {
  gmImage: serverGMImage_,
  processMarkdown: serverProcessMarkdown_,
  status: handleStatusRequest,
  // ... –≤—Å–µ —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
};

/**
 * –û–±—Ä–∞–±–æ—Ç–∫–∞ Gemini Image –∑–∞–ø—Ä–æ—Å–∞
 */
function serverGMImage_(images, prompt, options) {
  // ... –ø–æ–ª–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∏–∑ ServerEndpoints.gs
  return result;
}

// ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
```

#### **–®–∞–≥ 2: –ü—É–±–ª–∏–∫—É–π –∫–∞–∫ Library**

1. –í Apps Script –ø—Ä–æ–µ–∫—Ç–µ: **Deploy ‚Üí New deployment**
2. Type: **Library**
3. Description: "Table AI Bot Server Library v1.0"
4. Access: **Anyone** (–∏–ª–∏ **Anyone with link**)
5. –ö–æ–ø–∏—Ä—É–π **Script ID**: `1abc...xyz`

#### **–®–∞–≥ 3: –ü–æ–¥–∫–ª—é—á–∏ –≤ –∫–∞–∂–¥—É—é —Ç–∞–±–ª–∏—Ü—É**

–í Apps Script —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ —Ç–∞–±–ª–∏—Ü—ã:

1. **Resources ‚Üí Libraries** (–∏–ª–∏ **+ –∏–∫–æ–Ω–∫–∞** –≤ –Ω–æ–≤–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ)
2. –í—Å—Ç–∞–≤—å Script ID: `1abc...xyz`
3. –í—ã–±–µ—Ä–∏ –≤–µ—Ä—Å–∏—é: **Head** (–≤—Å–µ–≥–¥–∞ –ø–æ—Å–ª–µ–¥–Ω—è—è) –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –≤–µ—Ä—Å–∏—é
4. Identifier: `ServerLib`
5. –ù–∞–∂–º–∏ **Add**

#### **–®–∞–≥ 4: –ò—Å–ø–æ–ª—å–∑—É–π –≤ –∫–æ–¥–µ —Ç–∞–±–ª–∏—Ü—ã**

```javascript
// –í ThinClient.gs —Ç–∞–±–ª–∏—Ü—ã

function serverGmOcrBatch_(images, prompt, options) {
  // –í–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ –≤—ã–∑–æ–≤–∞ - –∏—Å–ø–æ–ª—å–∑—É–π –±–∏–±–ª–∏–æ—Ç–µ–∫—É
  return ServerLib.gmImage(images, prompt, options);
}

function serverStatus_() {
  return ServerLib.status();
}
```

#### **–®–∞–≥ 5: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏**

```
1. –†–µ–¥–∞–∫—Ç–∏—Ä—É–π –∫–æ–¥ –≤ Library –ø—Ä–æ–µ–∫—Ç–µ
2. Deploy ‚Üí Manage deployments
3. Edit ‚Üí Version: New version
4. Description: "v1.1 - Added feature X"
5. Deploy!

‚Üí –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å –≤–µ—Ä—Å–∏–µ–π "Head" –ø–æ–ª—É—á–∞—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
```

---

### **–í–∞—Ä–∏–∞–Ω—Ç 2: GitHub Actions + Google Drive API**

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```
1. GitHub Actions —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç—Å—è –Ω–∞ push
2. –°–∫—Ä–∏–ø—Ç –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü –≤ –ø–∞–ø–∫–µ Drive
3. –î–ª—è –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã - –æ–±–Ω–æ–≤–ª—è–µ—Ç Apps Script –∫–æ–¥
4. –õ–æ–≥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–µ–ø–ª–æ—è
```

**–ü–ª—é—Å—ã:**
- ‚úÖ **–ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å** - –≤–∏–¥–Ω–æ —á—Ç–æ –∏ –∫—É–¥–∞ –¥–µ–ø–ª–æ–∏—Ç—Å—è
- ‚úÖ **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - —á–µ—Ä–µ–∑ Git
- ‚úÖ **CI/CD pipeline** - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- ‚úÖ **Rollback** - –æ—Ç–∫–∞—Ç —á–µ—Ä–µ–∑ Git

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –°–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç Google Drive API access
- ‚ö†Ô∏è –î–æ–ª–≥–∏–π –¥–µ–ø–ª–æ–π (–µ—Å–ª–∏ –º–Ω–æ–≥–æ —Ç–∞–±–ª–∏—Ü)

**–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:**

#### **–®–∞–≥ 1: –ü–æ–ª—É—á–∏ —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü –≤ –ø–∞–ø–∫–µ**

```javascript
// deploy-to-folder.js

const { google } = require('googleapis');
const fs = require('fs');

const FOLDER_ID = 'YOUR_DRIVE_FOLDER_ID'; // ID –ø–∞–ø–∫–∏ –Ω–∞ Drive

async function getSpreadsheetIds(auth) {
  const drive = google.drive({ version: 'v3', auth });
  
  // –ù–∞–π—Ç–∏ –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –≤ –ø–∞–ø–∫–µ
  const res = await drive.files.list({
    q: `'${FOLDER_ID}' in parents and mimeType='application/vnd.google-apps.spreadsheet'`,
    fields: 'files(id, name)',
    pageSize: 100
  });
  
  return res.data.files;
}

async function deployToAllSheets() {
  const auth = await authenticate();
  const sheets = await getSpreadsheetIds(auth);
  
  console.log(`Found ${sheets.length} spreadsheets in folder`);
  
  for (const sheet of sheets) {
    console.log(`Deploying to: ${sheet.name} (${sheet.id})`);
    await deployToSheet(auth, sheet.id);
  }
  
  console.log('‚úÖ All deployments completed!');
}
```

#### **–®–∞–≥ 2: –î–µ–ø–ª–æ–π –≤ –∫–∞–∂–¥—É—é —Ç–∞–±–ª–∏—Ü—É**

```javascript
async function deployToSheet(auth, spreadsheetId) {
  const script = google.script({ version: 'v1', auth });
  
  // –ü–æ–ª—É—á–∏—Ç—å Script ID –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
  const scriptId = await getScriptIdFromSpreadsheet(auth, spreadsheetId);
  
  if (!scriptId) {
    console.warn(`No script found for ${spreadsheetId}, skipping`);
    return;
  }
  
  // –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª—ã –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
  const files = [
    { name: 'ThinClient', content: fs.readFileSync('table/client/ThinClient.gs', 'utf8') },
    { name: 'ClientUtilities', content: fs.readFileSync('table/client/ClientUtilities.gs', 'utf8') },
    // ... –≤—Å–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ —Ñ–∞–π–ª—ã
  ];
  
  // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–¥ –≤ —Ç–∞–±–ª–∏—Ü–µ
  await script.projects.updateContent({
    scriptId: scriptId,
    requestBody: { files: files }
  });
  
  console.log(`‚úÖ Deployed to ${spreadsheetId}`);
}
```

#### **–®–∞–≥ 3: GitHub Actions workflow**

```yaml
# .github/workflows/deploy-to-drive-folder.yml

name: Deploy to Drive Folder

on:
  push:
    branches: [main]
    paths:
      - 'table/client/**'

jobs:
  deploy-folder:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node
        uses: actions/setup-node@v3
        with:
          node-version: '18'
      
      - name: Install dependencies
        run: npm install googleapis@latest
      
      - name: Deploy to all sheets in folder
        env:
          GOOGLE_CREDENTIALS: ${{ secrets.GOOGLE_CREDENTIALS }}
          DRIVE_FOLDER_ID: ${{ secrets.DRIVE_FOLDER_ID }}
        run: node deploy-to-folder.js
```

---

### **–í–∞—Ä–∏–∞–Ω—Ç 3: Master Sheet + Installer**

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```
1. –ï—Å—Ç—å "Master —Ç–∞–±–ª–∏—Ü–∞" —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º –∫–æ–¥–æ–º
2. –í –∫–∞–∂–¥–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Ç–∞–±–ª–∏—Ü–µ - –∫–Ω–æ–ø–∫–∞ "Update from Master"
3. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ - –∫–æ–ø–∏—Ä—É–µ—Ç –∫–æ–¥ –∏–∑ Master —Ç–∞–±–ª–∏—Ü—ã
4. –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
```

**–ü–ª—é—Å—ã:**
- ‚úÖ **–ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è** - —á–∏—Å—Ç—ã–π Apps Script
- ‚úÖ **–ö–æ–Ω—Ç—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** - –æ–Ω —Ä–µ—à–∞–µ—Ç –∫–æ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è
- ‚úÖ **–ù–µ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤**

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –ù—É–∂–Ω–æ –Ω–∞–∂–∏–º–∞—Ç—å –∫–Ω–æ–ø–∫—É –≤—Ä—É—á–Ω—É—é
- ‚ö†Ô∏è Master —Ç–∞–±–ª–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∞ –≤—Å–µ–º

**–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:**

```javascript
// –í –∫–∞–∂–¥–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Ç–∞–±–ª–∏—Ü–µ: UpdateManager.gs

var MASTER_SHEET_ID = 'YOUR_MASTER_SHEET_ID';
var CURRENT_VERSION = '1.0.0'; // –•—Ä–∞–Ω–∏—Ç—å –≤ Script Properties

/**
 * –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
 */
function checkForUpdates() {
  var masterSS = SpreadsheetApp.openById(MASTER_SHEET_ID);
  var masterVersion = masterSS.getRangeByName('VERSION').getValue();
  
  if (masterVersion > CURRENT_VERSION) {
    var ui = SpreadsheetApp.getUi();
    var result = ui.alert(
      '–î–æ—Å—Ç—É–ø–Ω–∞ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è!',
      '–í–µ—Ä—Å–∏—è ' + masterVersion + ' –¥–æ—Å—Ç—É–ø–Ω–∞. –û–±–Ω–æ–≤–∏—Ç—å —Å–µ–π—á–∞—Å?',
      ui.ButtonSet.YES_NO
    );
    
    if (result === ui.Button.YES) {
      installUpdate();
    }
  } else {
    SpreadsheetApp.getUi().alert('–£ –≤–∞—Å –ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è!');
  }
}

/**
 * –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
 */
function installUpdate() {
  try {
    // 1. –°–∫–∞—á–∞—Ç—å –∫–æ–¥ –∏–∑ Master —Ç–∞–±–ª–∏—Ü—ã
    var masterSS = SpreadsheetApp.openById(MASTER_SHEET_ID);
    var codeSheet = masterSS.getSheetByName('__CODE__');
    
    if (!codeSheet) {
      throw new Error('Master sheet –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏—Å—Ç __CODE__');
    }
    
    var codeData = codeSheet.getDataRange().getValues();
    
    // 2. –†–∞—Å–ø–∞—Ä—Å–∏—Ç—å –∫–æ–¥ —Ñ–∞–π–ª–æ–≤
    var files = parseCodeFiles(codeData);
    
    // 3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Apps Script API
    // (–ù—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ ScriptApp.getScriptId())
    var scriptId = ScriptApp.getScriptId();
    
    // ... –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Google Apps Script API –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    
    // 4. –û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é
    PropertiesService.getScriptProperties().setProperty('VERSION', 
      masterSS.getRangeByName('VERSION').getValue());
    
    SpreadsheetApp.getUi().alert('‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ!');
  } catch (e) {
    SpreadsheetApp.getUi().alert('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: ' + e.message);
  }
}

/**
 * –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
 */
function onOpen(e) {
  // –ü—Ä–æ–≤–µ—Ä—è—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–∑ –≤ –¥–µ–Ω—å
  var lastCheck = PropertiesService.getUserProperties().getProperty('LAST_UPDATE_CHECK');
  var now = new Date().getTime();
  
  if (!lastCheck || now - parseInt(lastCheck) > 24 * 60 * 60 * 1000) {
    checkForUpdates();
    PropertiesService.getUserProperties().setProperty('LAST_UPDATE_CHECK', now.toString());
  }
}
```

---

### **–í–∞—Ä–∏–∞–Ω—Ç 4: Template + Add-on**

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```
1. –°–æ–∑–¥–∞—ë—à—å Google Workspace Add-on
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç Add-on
3. Add-on –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ Google Workspace Marketplace
4. –ö–æ–¥ –≤—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π
```

**–ü–ª—é—Å—ã:**
- ‚úÖ **–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –ø—É—Ç—å** - –∫–∞–∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** - —á–µ—Ä–µ–∑ Marketplace
- ‚úÖ **OAuth scopes** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏
- ‚úÖ **–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è** - –º–æ–∂–Ω–æ –ø—Ä–æ–¥–∞–≤–∞—Ç—å

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –°–ª–æ–∂–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ Marketplace
- ‚ö†Ô∏è –ü—Ä–æ—Ü–µ—Å—Å review –æ—Ç Google

---

## üéØ **–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø**

### **–î–ª—è —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ —è —Ä–µ–∫–æ–º–µ–Ω–¥—É—é: –í–∞—Ä–∏–∞–Ω—Ç 1 (Apps Script Library)**

**–ü–æ—á–µ–º—É:**
1. ‚úÖ **–ë—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è** - 1-2 —á–∞—Å–∞ —Ä–∞–±–æ—Ç—ã
2. ‚úÖ **Google native** - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±
3. ‚úÖ **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –Ω–æ–≤—ã–π –∫–æ–¥
4. ‚úÖ **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - –º–æ–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å
5. ‚úÖ **–°–æ–≤–º–µ—Å—Ç–∏–º —Å —Ç–µ–∫—É—â–∏–º workflow** - GitHub ‚Üí Library ‚Üí Tables

### **–ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:**

**–§–∞–∑–∞ 1: –°–æ–∑–¥–∞—Ç—å Library (1 —á–∞—Å)**
1. –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π Apps Script –ø—Ä–æ–µ–∫—Ç
2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—ã–π –∫–æ–¥
3. –û–±–µ—Ä–Ω—É—Ç—å –≤ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–π –æ–±—ä–µ–∫—Ç
4. –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∫–∞–∫ Library

**–§–∞–∑–∞ 2: –û–±–Ω–æ–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ (30 –º–∏–Ω)**
1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å Library –≤–æ –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã
2. –ó–∞–º–µ–Ω–∏—Ç—å –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã –Ω–∞ `ServerLib.function()`
3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–§–∞–∑–∞ 3: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (1 —á–∞—Å)**
1. GitHub Actions –æ–±–Ω–æ–≤–ª—è–µ—Ç Library –ø—Ä–∏ push
2. –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ–ª—É—á–∞—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## üìù **–ü–†–ò–ú–ï–† –ê–†–•–ò–¢–ï–ö–¢–£–†–´**

```
GitHub Repository (ai_table)
    ‚Üì push to main
GitHub Actions (deploy.yml)
    ‚Üì deploy
Apps Script Library Project (Server Library)
    ‚Üì version: "Head"
    ‚Üì –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫–∞–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
Google Sheets Tables (–≤ –ø–∞–ø–∫–µ Drive)
    ‚Üì –∏—Å–ø–æ–ª—å–∑—É—é—Ç
ServerLib.gmImage()
ServerLib.status()
ServerLib.processMarkdown()
    ...
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- Single source of truth (Library)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- –û—Ç–∫–∞—Ç –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

---

## üöÄ **–•–û–ß–ï–®–¨ –†–ï–ê–õ–ò–ó–û–í–ê–¢–¨?**

**–Ø –º–æ–≥—É:**
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É Apps Script Library
2. ‚úÖ –û–±–µ—Ä–Ω—É—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å–µ—Ä–≤–µ—Ä–Ω—ã–π –∫–æ–¥
3. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å GitHub Actions –¥–ª—è –¥–µ–ø–ª–æ—è –≤ Library
4. ‚úÖ –°–æ–∑–¥–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é –≤ —Ç–∞–±–ª–∏—Ü—ã
5. ‚úÖ –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è Library

**–ß—Ç–æ –≤—ã–±–∏—Ä–∞–µ—à—å:**
- **A) Apps Script Library** (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é!)
- **B) GitHub Actions + Drive API** (—Å–ª–æ–∂–Ω–µ–µ –Ω–æ –≥–∏–±—á–µ)
- **C) Master Sheet + Installer** (–ø—Ä–æ—â–µ –Ω–æ —Ä—É—á–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å)
- **D) –ß—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ?**

**–ù–∞—á–∏–Ω–∞–µ–º? üöÄ**
